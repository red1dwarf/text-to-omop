{"input": "Question: What are the top 4 frequent prescribed drugs for patients who were also prescribed <DRUG>19041823</DRUG> at the same time on the last hospital visit?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: Which 4 drugs are most frequently co-prescribed with <DRUG>19041823</DRUG> during the last hospital visit?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: What are the top 4 medications commonly given alongside <DRUG>19041823</DRUG> in the most recent hospital stay?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: During the latest hospital visit, what 4 drugs were most often prescribed together with <DRUG>19041823</DRUG>?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: List the 4 most frequent drugs co-administered with <DRUG>19041823</DRUG> in the patient's last hospital admission.\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: What are the four most commonly prescribed medications at the same time as <DRUG>19041823</DRUG> during a patient's last visit?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: Find the top 4 drugs prescribed with <DRUG>19041823</DRUG> during the most recent hospital encounter.\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: Which four medications are most often prescribed together with <DRUG>19041823</DRUG> in the last hospital visit?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: Identify the top 4 co-prescribed drugs with <DRUG>19041823</DRUG> in a patient's final hospital visit.\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: What are the 4 drugs most frequently prescribed at the same time as <DRUG>19041823</DRUG> in their last admission?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: Which drugs were most often given alongside <DRUG>19041823</DRUG> during the patient's last hospital visit?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: Name the 4 most common medications prescribed concurrently with <DRUG>19041823</DRUG> during the last hospital visit.\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: What four other drugs are most frequently prescribed when <DRUG>19041823</DRUG> is prescribed in the last hospital visit?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: In the most recent hospital visit, which drugs were most commonly prescribed with <DRUG>19041823</DRUG>?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: Which are the top 4 drugs used alongside <DRUG>19041823</DRUG> in patients' latest hospitalizations?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: What four medications are typically co-prescribed with <DRUG>19041823</DRUG> at the time of the last hospital admission?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: Top 4 drugs prescribed concurrently with <DRUG>19041823</DRUG> during the latest hospital stay?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: Which medications were prescribed most often with <DRUG>19041823</DRUG> during patientsâ€™ most recent visits?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: What are the four most frequently co-prescribed drugs during the last hospital admission involving <DRUG>19041823</DRUG>?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: Identify four drugs that are commonly administered with <DRUG>19041823</DRUG> in the most recent hospital stay.\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: During their last hospital visit, what are the top four drugs patients received alongside <DRUG>19041823</DRUG>?\n\nSQL:", "output": "WITH last_visits AS ( SELECT person_id, MAX(visit_occurrence_id) AS last_visit_id FROM drug_exposure GROUP BY person_id ), target_patients_dates AS ( SELECT DISTINCT person_id, visit_occurrence_id, drug_exposure_start_date FROM drug_exposure WHERE drug_concept_id = 19041823 AND (person_id, visit_occurrence_id) IN ( SELECT person_id, last_visit_id FROM last_visits ) ), drugs_same_time AS ( SELECT drug_concept_id FROM drug_exposure WHERE (person_id, visit_occurrence_id, drug_exposure_start_date) IN ( SELECT person_id, visit_occurrence_id, drug_exposure_start_date FROM target_patients_dates ) ) SELECT drug_concept_id, COUNT(*) AS freq FROM drugs_same_time WHERE drug_concept_id != 0 GROUP BY drug_concept_id ORDER BY freq DESC LIMIT 4;"}
{"input": "Question: what are the top 3 frequent diagnoses of patients aged 60's or above last month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: Which diagnoses were most common among patients aged 60 and older last month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: What were the top 3 diagnoses for patients over 60 during the previous month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: Can you list the three most frequent diagnoses in patients aged 60+ last month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: What are the leading diagnoses from last month in patients aged 60 or more?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: What were the most reported conditions among people aged 60 and above last month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: Which three diagnoses occurred most frequently in seniors (60+) last month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: Top 3 diagnoses among patients aged 60 or above in the last month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: Identify the top three conditions affecting patients 60 and older last month.\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: What are the three most common diagnoses for elderly patients last month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: Which diagnoses were recorded most often last month for those 60 years and up?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: Name the top 3 frequent diagnoses among people aged 60+ during the last month.\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: What conditions were diagnosed most in patients aged 60+ in the previous month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: What are the highest occurring diagnoses last month for seniors aged 60 and over?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: Which diagnoses topped the list for patients aged 60 or older last month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: Which three diagnoses were most frequent in the elderly (60+) population last month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: Last month, what were the top three diagnoses for patients aged 60 and up?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: Give the top 3 most common conditions for patients 60+ from last month.\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: What were the dominant diagnoses in patients aged 60 and older during last month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: What are the most frequent diagnoses in those aged 60 or more from the last month?\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: List the three most diagnosed conditions in the 60+ age group last month.\n\nSQL:", "output": "SELECT condition_concept_id, COUNT(*) AS diagnosis_count FROM condition_occurrence WHERE condition_start_date >= date_trunc('month', CURRENT_DATE - INTERVAL '1 month') AND condition_start_date < date_trunc('month', CURRENT_DATE) AND person_id IN (SELECT person_id FROM person WHERE EXTRACT(YEAR FROM AGE(CURRENT_DATE, make_date(year_of_birth, 1, 1))) >= 60) GROUP BY condition_concept_id ORDER BY diagnosis_count DESC LIMIT 3;"}
{"input": "Question: What percentile is the value of 1.3 in a <MEASUREMENT>3022217</MEASUREMENT> lab test among patients of the same age as patient 4924550704026979905 in March/last year?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: At what percentile does the value 1.3 fall in the <MEASUREMENT>3022217</MEASUREMENT> test for patients the same age as patient 4924550704026979905 in March last year?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: How does a value of 1.3 rank percentile-wise in the <MEASUREMENT>3022217</MEASUREMENT> lab test for patients the same age as patient 4924550704026979905 during last March?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: What percentile does 1.3 correspond to in the <MEASUREMENT>3022217</MEASUREMENT> measurement for patients of the same age as patient 4924550704026979905 in March of the previous year?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: In March last year, what percentile was the value 1.3 in the <MEASUREMENT>3022217</MEASUREMENT> lab results of patients the same age as patient 4924550704026979905?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: What was the percentile of 1.3 in the <MEASUREMENT>3022217</MEASUREMENT> test results among same-age peers of patient 4924550704026979905 last March?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: Among patients the same age as patient 4924550704026979905 in March of last year, what percentile is the lab value 1.3 in <MEASUREMENT>3022217</MEASUREMENT>?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: What percentile does a 1.3 value hold in the <MEASUREMENT>3022217</MEASUREMENT> test for similar-aged patients to patient 4924550704026979905 in March last year?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: How does the value 1.3 compare percentile-wise in <MEASUREMENT>3022217</MEASUREMENT> for patients the same age as patient 4924550704026979905 in March a year ago?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: What is the percentile ranking of 1.3 in <MEASUREMENT>3022217</MEASUREMENT> for people the same age as patient 4924550704026979905 last March?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: During last March, what percentile does 1.3 fall into for <MEASUREMENT>3022217</MEASUREMENT> among those the same age as patient 4924550704026979905?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: In the <MEASUREMENT>3022217</MEASUREMENT> test, what percentile is 1.3 for those the same age as patient 4924550704026979905 during March of last year?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: Where does the lab result 1.3 fall in the percentile distribution of <MEASUREMENT>3022217</MEASUREMENT> for age-matched patients to 4924550704026979905 last March?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: What is the percentile for a 1.3 result in <MEASUREMENT>3022217</MEASUREMENT> among patients matching the age of 4924550704026979905 last year in March?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: What percentile does 1.3 occupy in <MEASUREMENT>3022217</MEASUREMENT> for patients born the same year as 4924550704026979905 during March of last year?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: Among peers of patient 4924550704026979905 by age in March last year, where does a 1.3 score rank in the <MEASUREMENT>3022217</MEASUREMENT> test?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: What percentile corresponds to a value of 1.3 in the <MEASUREMENT>3022217</MEASUREMENT> test among patients of the same age group as 4924550704026979905 last March?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: How does 1.3 rank in terms of percentiles in <MEASUREMENT>3022217</MEASUREMENT> from last March among those the same age as patient 4924550704026979905?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: For the <MEASUREMENT>3022217</MEASUREMENT> test last March, what percentile is 1.3 among same-age patients as 4924550704026979905?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: What is the percentile rank for a 1.3 value in the <MEASUREMENT>3022217</MEASUREMENT> lab test in March last year for same-aged individuals as patient 4924550704026979905?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: How is the value 1.3 positioned percentile-wise in <MEASUREMENT>3022217</MEASUREMENT> among those the same age as patient 4924550704026979905 in March last year?\n\nSQL:", "output": "WITH patient_birth_year AS (SELECT year_of_birth FROM person WHERE person_id = 4924550704026979905), filtered_measurements AS (SELECT value_as_number FROM measurement WHERE measurement_concept_id = 3022217 AND EXTRACT(YEAR FROM measurement_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND EXTRACT(MONTH FROM measurement_date) = 3 AND person_id IN (SELECT person_id FROM person WHERE year_of_birth = (SELECT year_of_birth FROM patient_birth_year)) AND value_as_number IS NOT NULL), ranked_values AS (SELECT value_as_number, PERCENT_RANK() OVER (ORDER BY value_as_number) AS percentile FROM filtered_measurements) SELECT percentile FROM ranked_values WHERE value_as_number = 1.3 LIMIT 1;"}
{"input": "Question: What was the name of the drug that patient 449512254961891092 was at 2145-09-19 20:00:00 prescribed via route <ROUTE>4142048</ROUTE>?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Please provide the name of the drug prescribed to patient 449512254961891092 was administered through the route <ROUTE>4142048</ROUTE> on 2145-09-19 at 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Please provide the name of the drug prescribed to patient 449512254961891092 was prescribed via route <ROUTE>4142048</ROUTE> on 2145-09-19 at 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Identify the drug that was given to patient 449512254961891092 was prescribed through <ROUTE>4142048</ROUTE> at exactly 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Please provide the name of the drug prescribed to patient 449512254961891092 was administered via <ROUTE>4142048</ROUTE> at 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: What is the drug that was prescribed to patient 449512254961891092 was prescribed through <ROUTE>4142048</ROUTE> at exactly 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Which drug was administered to patient 449512254961891092 was prescribed through <ROUTE>4142048</ROUTE> at exactly 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Identify the drug that was given to patient 449512254961891092 was administered through the route <ROUTE>4142048</ROUTE> on 2145-09-19 at 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Which medication was administered to patient 449512254961891092 was given by <ROUTE>4142048</ROUTE> on 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Which medication was administered to patient 449512254961891092 was given by <ROUTE>4142048</ROUTE> on 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Can you tell me the name of the drug prescribed to patient 449512254961891092 was administered via <ROUTE>4142048</ROUTE> at 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Can you tell me the name of the drug prescribed to patient 449512254961891092 was given via <ROUTE>4142048</ROUTE> exactly at 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Name the drug that patient 449512254961891092 got via <ROUTE>4142048</ROUTE> at the date and time 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: What medication did patient 449512254961891092 was prescribed via route <ROUTE>4142048</ROUTE> on 2145-09-19 at 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: What medication did patient 449512254961891092 was prescribed via route <ROUTE>4142048</ROUTE> on 2145-09-19 at 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Identify the drug that was given to patient 449512254961891092 got via <ROUTE>4142048</ROUTE> at the date and time 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: What medication did patient 449512254961891092 was given through <ROUTE>4142048</ROUTE> at 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Which medication was administered to patient 449512254961891092 was given through <ROUTE>4142048</ROUTE> at 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Tell me which drug patient 449512254961891092 was administered through the route <ROUTE>4142048</ROUTE> on 2145-09-19 at 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: Can you tell me the name of the drug prescribed to patient 449512254961891092 received at 2145-09-19 20:00:00 through the route <ROUTE>4142048</ROUTE>?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: What is the drug that was prescribed to patient 449512254961891092 got via <ROUTE>4142048</ROUTE> at the date and time 2145-09-19 20:00:00?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT drug_concept_id FROM drug_exposure WHERE person_id = 449512254961891092 AND exposure_start_datetime = TIMESTAMP '2145-09-19 20:00:00' AND route_concept_id = 4142048 LIMIT 1) LIMIT 1;"}
{"input": "Question: What was the name of the specimen that patient 6819106907993465128 was first tested on the first hospital visit?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Which sample was taken first from patient 6819106907993465128 on their first hospital visit?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Can you tell me the name of the specimen first tested for patient 6819106907993465128 at the first hospital visit?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Can you tell me the name of the specimen first tested for patient 6819106907993465128 in their first recorded hospital encounter?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Name the specimen that was tested first on patient 6819106907993465128 during the first visit to the hospital?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Which specimen was tested first for patient 6819106907993465128 during their initial hospital visit?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: What was the specimen tested on the first hospital visit of patient 6819106907993465128 in their first recorded hospital encounter?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Name the specimen that was tested first on patient 6819106907993465128 during the first visit to the hospital?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Identify the first specimen that was tested for patient 6819106907993465128 on their first hospital visit?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Which sample was taken first from patient 6819106907993465128 during their initial hospital visit?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Give the name of the first tested specimen for patient 6819106907993465128 during the first visit to the hospital?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: What was the specimen tested on the first hospital visit of patient 6819106907993465128 at the first hospital visit?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Tell me the name of the first specimen tested during patient 6819106907993465128 at the time of their first hospital stay?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Name the specimen that was tested first on patient 6819106907993465128 on their initial hospitalization?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Can you tell me the name of the specimen first tested for patient 6819106907993465128 on their initial hospitalization?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Please provide the specimen name that was tested first for patient 6819106907993465128 during the first visit to the hospital?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Which specimen was tested first for patient 6819106907993465128 on the patient's first hospital admission?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: What specimen was collected first from patient 6819106907993465128 during their initial hospital visit?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Which specimen was tested first for patient 6819106907993465128 at the time of their first hospital stay?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Can you tell me the name of the specimen first tested for patient 6819106907993465128 on the occasion of their first hospital visit?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: Give the name of the first tested specimen for patient 6819106907993465128 in their first recorded hospital encounter?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id = (SELECT specimen_concept_id FROM (SELECT specimen_concept_id FROM specimen WHERE person_id = 6819106907993465128 AND specimen_date BETWEEN (SELECT visit_start_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 6819106907993465128 ORDER BY visit_start_date ASC LIMIT 1) AND specimen_concept_id IS NOT NULL ORDER BY specimen_date, specimen_datetime LIMIT 1) AS first_specimen) LIMIT 1;"}
{"input": "Question: What are the top 5 frequent diagnoses on August/23/2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: What are the five most frequent diagnoses on on 2123-Aug-23?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Identify the most common five diagnoses on the 23rd of August, 2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: What are the five most frequent diagnoses on the date August 23, 2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Name the five most recorded diagnoses on 2123-08-23?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Which are the top 5 most common diagnoses recorded on August/23/2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Name the five most recorded diagnoses on the date August 23, 2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Give me the 5 most frequent diagnoses that occurred on August 23rd, 2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: List the top five diagnoses reported for the date 2123/08/23?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Can you list the 5 top diagnoses on 2123-Aug-23?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Name the five most recorded diagnoses for the date 2123/08/23?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Can you list the 5 top diagnoses on August/23/2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: List the top five diagnoses reported on the 23rd of August, 2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Show the top 5 frequent medical diagnoses for the date August 23, 2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Identify the most common five diagnoses from 23 August 2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Give me the 5 most frequent diagnoses that occurred on 23 August 2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Identify the most common five diagnoses on 23 August 2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: List the top five diagnoses reported on the day 23/08/2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Give me the 5 most frequent diagnoses that occurred from the date August 23, 2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Can you list the 5 top diagnoses on the 23rd of August, 2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: Can you list the 5 top diagnoses from from the day 23/08/2123?\n\nSQL:", "output": "SELECT concept_name FROM concept WHERE concept_id IN (SELECT condition_concept_id FROM (SELECT condition_concept_id FROM condition_occurrence WHERE condition_start_date = DATE '2123-08-23' AND condition_concept_id IS NOT NULL GROUP BY condition_concept_id ORDER BY COUNT(*) DESC LIMIT 5) AS top_diagnoses) LIMIT 5;"}
{"input": "Question: What was the second measured weight of patient 1922226694437355804 on July/16/last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Tell me the second measured weight value for patient 1922226694437355804 for July 16th last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Retrieve the second weight value recorded for patient 1922226694437355804 from July 16 last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Please show the second documented weight of patient 1922226694437355804 measured on 16 July last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Give me the second weight measurement for patient 1922226694437355804 recorded on July/16 of the previous year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Identify the second time weight was measured for patient 1922226694437355804 recorded on 2024-07-16?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Fetch the second time weight was captured for patient 1922226694437355804 recorded on July/16 of the previous year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Retrieve the second weight value recorded for patient 1922226694437355804 for July 16th last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Identify the second time weight was measured for patient 1922226694437355804 measured on 16 July last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Tell me the second measured weight value for patient 1922226694437355804 measured on 16 July last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Retrieve the second weight value recorded for patient 1922226694437355804 measured on 16 July last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Give me the second weight measurement for patient 1922226694437355804 for July 16th last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Identify the second time weight was measured for patient 1922226694437355804 on the previous year's July 16?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Give me the second weight measurement for patient 1922226694437355804 recorded on 2024-07-16?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Identify the second time weight was measured for patient 1922226694437355804 on the previous year's July 16?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Which value was the second measured weight for patient 1922226694437355804 on the day 16/07/last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Give me the second weight measurement for patient 1922226694437355804 on the previous year's July 16?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Which value was the second measured weight for patient 1922226694437355804 on July/16/last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Give me the second weight measurement for patient 1922226694437355804 on July/16/last year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Can you provide the second measured weight of patient 1922226694437355804 on the previous year's July 16?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Retrieve the second weight value recorded for patient 1922226694437355804 recorded on July/16 of the previous year?\n\nSQL:", "output": "SELECT value_as_number FROM (SELECT value_as_number FROM measurement WHERE person_id = 1922226694437355804 AND measurement_concept_id = 3025315 AND measurement_date = (DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year') + INTERVAL '6 months' + INTERVAL '15 days' AND value_as_number IS NOT NULL ORDER BY measurement_datetime ASC NULLS LAST, measurement_id ASC OFFSET 1 LIMIT 1) AS second_weight LIMIT 1;"}
{"input": "Question: Count the number of patients who were dead after having been diagnosed with <CONDITION>438120</CONDITION> within the same day since 7 month ago.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: What is the count of deaths on the same day as diagnosis with <CONDITION>438120</CONDITION> and passed away that day in the last 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: How many deaths occurred on the same day as diagnosis for <CONDITION>438120</CONDITION> on the same day in the last 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Calculate the number of patients who died after being diagnosed with <CONDITION>438120</CONDITION> on the same day in the last 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Find the number of patients who were diagnosed and then died the same day with <CONDITION>438120</CONDITION> the same day since seven months ago.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Find the number of patients who were diagnosed and then died the same day with <CONDITION>438120</CONDITION> on the same day in the last 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: How many patients died on the same day they were diagnosed with <CONDITION>438120</CONDITION> the same day since seven months ago.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: How many individuals died within the same day of being diagnosed with <CONDITION>438120</CONDITION> with same-day death from 7 months ago.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: How many deaths occurred on the same day as diagnosis for <CONDITION>438120</CONDITION> and passed away that day in the last 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: How many deaths occurred on the same day as diagnosis for <CONDITION>438120</CONDITION> on the same day in the last 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Count patients who passed away the same day as diagnosis of <CONDITION>438120</CONDITION> and died the same day since seven months ago.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Count patients who passed away the same day as diagnosis of <CONDITION>438120</CONDITION> the same day over the past seven months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: What is the count of deaths on the same day as diagnosis with <CONDITION>438120</CONDITION> the same day since seven months ago.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Calculate the number of patients who died after being diagnosed with <CONDITION>438120</CONDITION> with same-day death from 7 months ago.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Calculate the number of patients who died after being diagnosed with <CONDITION>438120</CONDITION> on the same calendar day over the past 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Tell me the number of people who were diagnosed and died the same day from <CONDITION>438120</CONDITION> on the same calendar day over the past 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Give the number of patients who died following a diagnosis of <CONDITION>438120</CONDITION> on the same day in the last 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Determine how many patients died the same day they were diagnosed with <CONDITION>438120</CONDITION> and passed away that day in the last 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: How many deaths occurred on the same day as diagnosis for <CONDITION>438120</CONDITION> and passed away that day in the last 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Tell me the number of people who were diagnosed and died the same day from <CONDITION>438120</CONDITION> the same day over the past seven months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: Find the number of patients who were diagnosed and then died the same day with <CONDITION>438120</CONDITION> on the same calendar day over the past 7 months.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c.person_id) FROM (SELECT c.person_id FROM condition_occurrence c WHERE c.condition_concept_id = 438120 AND c.condition_start_date >= CURRENT_DATE - INTERVAL '7 month' AND c.person_id IN (SELECT d.person_id FROM death d WHERE d.death_date = c.condition_start_date)) AS patients_dead_same_day;"}
{"input": "Question: When was the second hospital discharge time of patient 2219414084045702174 in May/last year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: Tell me when the second discharge occurred for patient 2219414084045702174 on May of last year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: Fetch the date of second discharge for patient 2219414084045702174 during May from the previous year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: What was the time of the second discharge of patient 2219414084045702174 in the month of May, last year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: Tell me when the second discharge occurred for patient 2219414084045702174 on May of last year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: On what date was the second discharge for patient 2219414084045702174 in May/last year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: At what time was the second hospital discharge for patient 2219414084045702174 during May from the previous year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: At what time was the second hospital discharge for patient 2219414084045702174 during last year's May?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: On what date did patient 2219414084045702174 have their second hospital discharge in May last year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: At what time was the second hospital discharge for patient 2219414084045702174 from May, a year ago?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: On what date was the second discharge for patient 2219414084045702174 during last year's May?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: On what date was the second discharge for patient 2219414084045702174 from May, a year ago?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: Can you tell me when patient 2219414084045702174 was discharged for the second time in May last year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: On what date was the second discharge for patient 2219414084045702174 in the month of May, last year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: At what time was the second hospital discharge for patient 2219414084045702174 during May from the previous year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: On what date was the second discharge for patient 2219414084045702174 on May of last year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: What was the time of the second discharge of patient 2219414084045702174 in May/last year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: What was the time of the second discharge of patient 2219414084045702174 from May, a year ago?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: Provide the second hospital discharge time of patient 2219414084045702174 in May of the previous year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: Give the date of the second hospital discharge for patient 2219414084045702174 on May of last year?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: At what time was the second hospital discharge for patient 2219414084045702174 from May, a year ago?\n\nSQL:", "output": "SELECT visit_end_date FROM (SELECT visit_end_date, ROW_NUMBER() OVER (ORDER BY visit_end_date) AS rn FROM (SELECT visit_end_date FROM visit_occurrence WHERE person_id = 2219414084045702174 AND visit_end_date BETWEEN make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 1) AND make_date(EXTRACT(YEAR FROM CURRENT_DATE)::int - 1, 5, 31) AND visit_end_date IS NOT NULL) AS filtered_visits) AS ranked_visits WHERE rn = 2;"}
{"input": "Question: What are the top four frequently prescribed drugs that female patients aged 20's were prescribed within 2 day after having been diagnosed with <CONDITION>318800</CONDITION> on this month/2?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Which four drugs were most commonly given to women in their 20s within 2 days after being diagnosed with <CONDITION>318800</CONDITION> this month/2?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: What are the four most frequent medications prescribed to females aged 20-29 within 2 days post-diagnosis of <CONDITION>318800</CONDITION> during this month/2?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: List the top four drugs given to 20-something women after a <CONDITION>318800</CONDITION> diagnosis within 2 days in this month/2.\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: During this month/2, which are the top 4 drugs prescribed to female patients in their twenties within 2 days of <CONDITION>318800</CONDITION> diagnosis?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Can you name the 4 most commonly prescribed medications for 20-year-old women diagnosed with <CONDITION>318800</CONDITION> within two days this month/2?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Top 4 drugs prescribed to females aged 20-29 within 2 days of being diagnosed with <CONDITION>318800</CONDITION> during this month/2?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Identify the top 4 prescriptions for women in their twenties following a <CONDITION>318800</CONDITION> diagnosis within 2 days this month/2.\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Which drugs were most frequently prescribed to young adult females after being diagnosed with <CONDITION>318800</CONDITION> within 2 days in this month/2?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Name the 4 top prescribed medications to 20s female patients shortly after being diagnosed with <CONDITION>318800</CONDITION> in this month/2.\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Find the four most commonly issued drugs for women in their 20s with a recent diagnosis of <CONDITION>318800</CONDITION> this month/2.\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: List top 4 drugs prescribed within 2 days to 20-29 year-old women diagnosed with <CONDITION>318800</CONDITION> during this month/2.\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Show the most prescribed four drugs for females in their twenties after being diagnosed with <CONDITION>318800</CONDITION> this month/2.\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: In this month/2, what are the top 4 drugs prescribed to women aged 20-29 after <CONDITION>318800</CONDITION> diagnosis within 2 days?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Highlight the four most used drugs among 20s women within 2 days of being diagnosed with <CONDITION>318800</CONDITION> this month/2.\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Top four drug prescriptions among women in their twenties diagnosed with <CONDITION>318800</CONDITION> this month/2 within 2 days?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Provide the 4 most prescribed drugs for young women (20s) after being diagnosed with <CONDITION>318800</CONDITION> this month/2.\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Which medications top the list for 20-something female patients post <CONDITION>318800</CONDITION> diagnosis this month/2?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Name top four prescribed medications for females aged 20-29 after <CONDITION>318800</CONDITION> diagnosis within 2 days this month/2.\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: During this month/2, what are the most prescribed 4 drugs to 20s females right after <CONDITION>318800</CONDITION> diagnosis?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: Which drugs are most frequently prescribed to women in their 20s after being diagnosed with <CONDITION>318800</CONDITION> this month/2?\n\nSQL:", "output": "SELECT de.drug_concept_id, COUNT(*) AS prescription_count FROM drug_exposure AS de WHERE de.person_id IN (SELECT p.person_id FROM person AS p WHERE p.gender_concept_id = 8532 AND EXTRACT(YEAR FROM age(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29) AND de.drug_exposure_start_date BETWEEN (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) AND (SELECT co.condition_start_date FROM condition_occurrence AS co WHERE co.condition_concept_id = 318800 AND co.condition_start_date >= DATE_TRUNC('month', CURRENT_DATE) AND co.condition_start_date < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month' AND de.person_id = co.person_id ORDER BY co.condition_start_date ASC LIMIT 1) + INTERVAL '2 days' GROUP BY de.drug_concept_id ORDER BY prescription_count DESC LIMIT 4;"}
{"input": "Question: When was the second to last time that patient 6657709864320620215 was prescribed <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> within the same day on the first ICU visit?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: What was the second most recent date when patient 6657709864320620215 received both <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> on the same day during their first ICU stay?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: On which date did patient 6657709864320620215 receive <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> together for the second to last time during the first ICU visit?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Can you identify the second to last day when patient 6657709864320620215 was prescribed both <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> on their initial ICU stay?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Tell me the date when patient 6657709864320620215 received both <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> for the second most recent time during the first ICU admission.\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Which day marks the second latest prescription of both <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> for patient 6657709864320620215 on their first ICU visit?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: What is the second latest occasion when patient 6657709864320620215 was administered <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> together during the first ICU stay?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Find the date of the second to last same-day prescription of <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> for patient 6657709864320620215 during their initial ICU visit.\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Give the second most recent instance when patient 6657709864320620215 was prescribed both <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> on their first ICU admission.\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: When was the penultimate date patient 6657709864320620215 received both <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> together during their initial ICU stay?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Identify the second last occurrence where patient 6657709864320620215 was given <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> on the same day during their first ICU visit.\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Second to last date patient 6657709864320620215 got both <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> in the same day during first ICU stay?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: What date marks the second previous co-prescription of <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> for patient 6657709864320620215 during the first ICU visit?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: When did patient 6657709864320620215 last receive <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> together before the most recent time in their initial ICU stay?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Find the date just before the most recent one when patient 6657709864320620215 received <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> together in their first ICU admission.\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: What's the second latest date patient 6657709864320620215 got both <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> during their first ICU visit?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Determine when was the second-to-latest date that <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> were prescribed together for patient 6657709864320620215 in their first ICU stay.\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Give me the second previous day that patient 6657709864320620215 was given <DRUG>1742258</DRUG> along with <DRUG>40175218</DRUG> on their first ICU visit.\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: What was the penultimate co-administration date of <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> for patient 6657709864320620215 during their first ICU encounter?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: When did patient 6657709864320620215 most recently before last receive both <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> during their initial ICU stay?\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Retrieve the second latest day of simultaneous administration of <DRUG>1742258</DRUG> and <DRUG>40175218</DRUG> to patient 6657709864320620215 on their first ICU admission.\n\nSQL:", "output": "SELECT prescription_date FROM (SELECT DISTINCT drug_exposure_start_date AS prescription_date FROM drug_exposure WHERE person_id = 6657709864320620215 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 6657709864320620215 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_detail WHERE visit_detail_concept_id IN (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%')) ORDER BY visit_start_date ASC LIMIT 1) AND drug_concept_id IN (1742258, 40175218) AND EXISTS (SELECT 1 FROM drug_exposure AS de2 WHERE de2.person_id = 6657709864320620215 AND de2.drug_concept_id IN (1742258, 40175218) AND de2.drug_exposure_start_date = drug_exposure.drug_exposure_start_date AND de2.drug_concept_id <> drug_exposure.drug_concept_id AND de2.visit_occurrence_id = drug_exposure.visit_occurrence_id)) AS prescription_dates ORDER BY prescription_date DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Count the number of patients who received a <PROCEDURE>2786472</PROCEDURE> procedure on the current hospital visit.\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: How many patients received a <PROCEDURE>2786472</PROCEDURE> procedure during their current hospital visit?\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Count how many patients underwent a <PROCEDURE>2786472</PROCEDURE> procedure on their current hospital stay.\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: How many individuals had a <PROCEDURE>2786472</PROCEDURE> procedure performed during this hospital admission?\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: What is the number of patients who received the <PROCEDURE>2786472</PROCEDURE> procedure on the current visit?\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Determine the count of patients who underwent a <PROCEDURE>2786472</PROCEDURE> procedure during their ongoing hospitalization.\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Give the number of patients treated with a <PROCEDURE>2786472</PROCEDURE> procedure in their current hospital visit.\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: How many patients went through a <PROCEDURE>2786472</PROCEDURE> procedure during this hospital stay?\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Total number of patients administered the <PROCEDURE>2786472</PROCEDURE> procedure during their current admission?\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Count the patients who had the <PROCEDURE>2786472</PROCEDURE> procedure done on their current hospital encounter.\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: What is the total number of patients who had a <PROCEDURE>2786472</PROCEDURE> procedure on this hospital visit?\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Find the number of patients that received a <PROCEDURE>2786472</PROCEDURE> procedure during this admission.\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Can you count how many patients had the <PROCEDURE>2786472</PROCEDURE> procedure on the current hospitalization?\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: How many were given a <PROCEDURE>2786472</PROCEDURE> procedure during the ongoing hospital stay?\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Count how many individuals received the <PROCEDURE>2786472</PROCEDURE> procedure on their current visit.\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Provide the count of patients who got a <PROCEDURE>2786472</PROCEDURE> procedure during the hospital admission.\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Number of patients who had a <PROCEDURE>2786472</PROCEDURE> procedure performed in the current hospital encounter?\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: What's the patient count for those who had a <PROCEDURE>2786472</PROCEDURE> procedure during their current hospital stay?\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Find out how many patients underwent the <PROCEDURE>2786472</PROCEDURE> procedure during their present hospitalization.\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: How many patients received the <PROCEDURE>2786472</PROCEDURE> procedure during this visit?\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Give the number of people who got a <PROCEDURE>2786472</PROCEDURE> procedure during the current hospital episode.\n\nSQL:", "output": "SELECT COUNT(DISTINCT person_id) AS patient_count FROM procedure_occurrence po WHERE po.procedure_concept_id = 2786472 AND po.visit_occurrence_id IN (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = po.person_id AND po.procedure_date BETWEEN vo.visit_start_date AND vo.visit_end_date);"}
{"input": "Question: Count the number of patients who were diagnosed with <CONDITION>4209423</CONDITION> within 3 months after having been diagnosed with <CONDITION>437474</CONDITION> since last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Determine the number of patients who received a diagnosis of <CONDITION>4209423</CONDITION> three months after a prior diagnosis of <CONDITION>437474</CONDITION> since the start of last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Report how many patients were diagnosed with <CONDITION>4209423</CONDITION> in the 3 months following a diagnosis of <CONDITION>437474</CONDITION> starting January 1st of the previous year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Tell me how many people have been diagnosed with <CONDITION>4209423</CONDITION> in the three-month window after diagnosis with <CONDITION>437474</CONDITION> since the beginning of the previous year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: What is the count of patients diagnosed with <CONDITION>4209423</CONDITION> within a 3-month period post-diagnosis of <CONDITION>437474</CONDITION> since the beginning of the previous year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: What is the count of patients diagnosed with <CONDITION>4209423</CONDITION> no later than 3 months after they were diagnosed with <CONDITION>437474</CONDITION> from the beginning of last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: How many patients have been diagnosed with <CONDITION>4209423</CONDITION> after being diagnosed with, within 3 months <CONDITION>437474</CONDITION> from the start of the last calendar year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Give me the count of patients with a diagnosis of <CONDITION>4209423</CONDITION> within a 3-month period post-diagnosis of <CONDITION>437474</CONDITION> since January 1st of last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: How many patients have been diagnosed with <CONDITION>4209423</CONDITION> up to 3 months after being diagnosed with <CONDITION>437474</CONDITION> since January 1st of last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Total patients diagnosed with <CONDITION>4209423</CONDITION> after being diagnosed with, within 3 months <CONDITION>437474</CONDITION> dating back to the first day of last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Identify the number of patients diagnosed with <CONDITION>4209423</CONDITION> no more than 3 months after diagnosis of <CONDITION>437474</CONDITION> as of the beginning of last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Total patients diagnosed with <CONDITION>4209423</CONDITION> no later than 3 months after they were diagnosed with <CONDITION>437474</CONDITION> since January 1st of last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Give me the count of patients with a diagnosis of <CONDITION>4209423</CONDITION> no later than 3 months after they were diagnosed with <CONDITION>437474</CONDITION> starting January 1st of the previous year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: What is the count of patients diagnosed with <CONDITION>4209423</CONDITION> three months after a prior diagnosis of <CONDITION>437474</CONDITION> since the beginning of the previous year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Identify the number of patients diagnosed with <CONDITION>4209423</CONDITION> within a 3-month period post-diagnosis of <CONDITION>437474</CONDITION> since the beginning of the previous year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Retrieve the count of individuals diagnosed with <CONDITION>4209423</CONDITION> no more than 3 months after diagnosis of <CONDITION>437474</CONDITION> since the first day of last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Give me the count of patients with a diagnosis of <CONDITION>4209423</CONDITION> within 3 months after a diagnosis of <CONDITION>437474</CONDITION> from the start of the last calendar year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Tell me how many people have been diagnosed with <CONDITION>4209423</CONDITION> after being diagnosed with, within 3 months <CONDITION>437474</CONDITION> since January 1st of last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Retrieve the count of individuals diagnosed with <CONDITION>4209423</CONDITION> no more than 3 months after diagnosis of <CONDITION>437474</CONDITION> since the beginning of last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Give me the count of patients with a diagnosis of <CONDITION>4209423</CONDITION> three months after a prior diagnosis of <CONDITION>437474</CONDITION> from January 1st last year.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: Identify the number of patients diagnosed with <CONDITION>4209423</CONDITION> after being diagnosed with, within 3 months <CONDITION>437474</CONDITION> from the start of last year onward.\n\nSQL:", "output": "SELECT COUNT(DISTINCT c1.person_id) AS patient_count FROM condition_occurrence c1 WHERE c1.condition_concept_id = 4209423 AND EXISTS (SELECT 1 FROM condition_occurrence c2 WHERE c2.person_id = c1.person_id AND c2.condition_concept_id = 437474 AND c2.condition_start_date >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND c1.condition_start_date BETWEEN c2.condition_start_date AND c2.condition_start_date + INTERVAL '3 months');"}
{"input": "Question: When was the second time that patient 6082951626122164742 was diagnosed with <CONDITION>40481043</CONDITION> until last year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Give the date of the second occurrence for patient 6082951626122164742 received a diagnosis of <CONDITION>40481043</CONDITION> before January 1st of this year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Could you find when patient 6082951626122164742 was identified with <CONDITION>40481043</CONDITION> prior to this calendar year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: When exactly did patient 6082951626122164742 got diagnosed with <CONDITION>40481043</CONDITION> until the last day of the previous year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Give the date of the second occurrence for patient 6082951626122164742 was confirmed with <CONDITION>40481043</CONDITION> as of last year end?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Identify the second diagnosis date for patient 6082951626122164742 was diagnosed with <CONDITION>40481043</CONDITION> until the last day of the previous year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: When did patient 6082951626122164742 was treated for <CONDITION>40481043</CONDITION> before the beginning of this year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: When exactly did patient 6082951626122164742 showed signs of <CONDITION>40481043</CONDITION> up to the end of the previous year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Identify the second diagnosis date for patient 6082951626122164742 was diagnosed with <CONDITION>40481043</CONDITION> before this year started?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Can you tell me when patient 6082951626122164742 was treated for <CONDITION>40481043</CONDITION> up to the end of the previous year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Please provide the date for the second diagnosis of 6082951626122164742 had a diagnosis of <CONDITION>40481043</CONDITION> until the last day of the previous year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: What was the date of the second time patient 6082951626122164742 was identified with <CONDITION>40481043</CONDITION> before this year started?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Can you tell me when patient 6082951626122164742 was found to have <CONDITION>40481043</CONDITION> until the end of last year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Could you find when patient 6082951626122164742 was identified with <CONDITION>40481043</CONDITION> by the close of last year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: When did patient 6082951626122164742 was treated for <CONDITION>40481043</CONDITION> before January 1st of this year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Identify the second diagnosis date for patient 6082951626122164742 got diagnosed with <CONDITION>40481043</CONDITION> prior to this calendar year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Give the date of the second occurrence for patient 6082951626122164742 had a diagnosis of <CONDITION>40481043</CONDITION> before the beginning of this year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Can you tell me when patient 6082951626122164742 was diagnosed with <CONDITION>40481043</CONDITION> until the last day of the previous year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: When exactly did patient 6082951626122164742 was found to have <CONDITION>40481043</CONDITION> prior to this calendar year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: When exactly did patient 6082951626122164742 received a diagnosis of <CONDITION>40481043</CONDITION> by the close of last year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: Identify the second diagnosis date for patient 6082951626122164742 showed signs of <CONDITION>40481043</CONDITION> before the beginning of this year?\n\nSQL:", "output": "SELECT condition_occurrence_id FROM (SELECT co.condition_occurrence_id, co.condition_start_date, ROW_NUMBER() OVER (ORDER BY co.condition_start_date) AS rn FROM condition_occurrence co WHERE co.person_id = 6082951626122164742 AND co.condition_concept_id = 40481043 AND co.condition_start_date < DATE_TRUNC('year', CURRENT_DATE)) AS ordered_conditions WHERE rn = 2;"}
{"input": "Question: What is the age of patient <PERSON_ID>7333484583531995140</PERSON_ID> until last month?\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: How old was the patient <PERSON_ID>7333484583531995140</PERSON_ID> as of the end of last month?\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Can you tell me the age of patient <PERSON_ID>7333484583531995140</PERSON_ID> up to the last month?\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: What was the patient's age <PERSON_ID>7333484583531995140</PERSON_ID> before this month?\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Give me the age of patient <PERSON_ID>7333484583531995140</PERSON_ID> as of last month.\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: What is the patient's age <PERSON_ID>7333484583531995140</PERSON_ID> calculated until the previous month?\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Find the age of <PERSON_ID>7333484583531995140</PERSON_ID> as of the last completed month.\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: What was the age of <PERSON_ID>7333484583531995140</PERSON_ID> by the end of last month?\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Please provide the age of patient <PERSON_ID>7333484583531995140</PERSON_ID> up to last month.\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: How old is <PERSON_ID>7333484583531995140</PERSON_ID> if you calculate until the last month?\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Determine the age of patient <PERSON_ID>7333484583531995140</PERSON_ID> before this month started.\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: I need the age of <PERSON_ID>7333484583531995140</PERSON_ID> up to the end of last month.\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Retrieve the age of patient <PERSON_ID>7333484583531995140</PERSON_ID> calculated through last month.\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Could you tell me the age of <PERSON_ID>7333484583531995140</PERSON_ID> as of last month?\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: As of the last month, what is the age of <PERSON_ID>7333484583531995140</PERSON_ID>?\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Report the patient's age <PERSON_ID>7333484583531995140</PERSON_ID> up to the previous month.\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Give the age of <PERSON_ID>7333484583531995140</PERSON_ID> ending last month.\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Provide the patient's age <PERSON_ID>7333484583531995140</PERSON_ID> as of the previous month.\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: How old is <PERSON_ID>7333484583531995140</PERSON_ID> considered at the end of last month?\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Get the age of patient <PERSON_ID>7333484583531995140</PERSON_ID> through the end of last month.\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: Fetch the age of <PERSON_ID>7333484583531995140</PERSON_ID> till the end of the last month.\n\nSQL:", "output": "SELECT DATE_PART('year', age((date_trunc('month', CURRENT_DATE) - INTERVAL '1 day')::date, (SELECT p.birth_datetime FROM person p WHERE p.person_id = 7333484583531995140))) AS age_last_month;"}
{"input": "Question: How many days have passed since the second time patient <PERSON_ID>4500356454715756250</PERSON_ID> stayed in careunit <CAREUNIT>4150077</CAREUNIT> on the current hospital visit?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: How long has it been since the second stay of patient <PERSON_ID>4500356454715756250</PERSON_ID> in careunit <CAREUNIT>4150077</CAREUNIT> during the current hospital visit?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: What is the number of days since patient <PERSON_ID>4500356454715756250</PERSON_ID> was in careunit <CAREUNIT>4150077</CAREUNIT> for the second time on this hospital visit?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: How many days ago was patient <PERSON_ID>4500356454715756250</PERSON_ID>'s second stay in careunit <CAREUNIT>4150077</CAREUNIT> during the current hospitalization?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: Since the second admission of <PERSON_ID>4500356454715756250</PERSON_ID> to <CAREUNIT>4150077</CAREUNIT>, how many days have passed?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: How much time has passed since <PERSON_ID>4500356454715756250</PERSON_ID> was in <CAREUNIT>4150077</CAREUNIT> for the second time in the current hospital stay?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: Days since the second stay of <PERSON_ID>4500356454715756250</PERSON_ID> in <CAREUNIT>4150077</CAREUNIT> on this hospital visit?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: How many days passed since the second occurrence of <PERSON_ID>4500356454715756250</PERSON_ID> being in <CAREUNIT>4150077</CAREUNIT> during the ongoing hospital visit?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: When did the second stay of patient <PERSON_ID>4500356454715756250</PERSON_ID> in careunit <CAREUNIT>4150077</CAREUNIT> happen, in days from today?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: Count the days since <PERSON_ID>4500356454715756250</PERSON_ID> last visited <CAREUNIT>4150077</CAREUNIT> for the second time this visit.\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: How many calendar days have passed since <PERSON_ID>4500356454715756250</PERSON_ID> was in <CAREUNIT>4150077</CAREUNIT> for their second visit during this hospital stay?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: Tell me how long it's been since <PERSON_ID>4500356454715756250</PERSON_ID> stayed in <CAREUNIT>4150077</CAREUNIT> for the second time during the current hospitalization.\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: Time in days since the second time <PERSON_ID>4500356454715756250</PERSON_ID> entered <CAREUNIT>4150077</CAREUNIT> on this hospital visit?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: How many days back did <PERSON_ID>4500356454715756250</PERSON_ID> stay in <CAREUNIT>4150077</CAREUNIT> for the second time during the present visit?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: Find the day difference since the second stay of <PERSON_ID>4500356454715756250</PERSON_ID> in <CAREUNIT>4150077</CAREUNIT> during this hospitalization.\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: Number of days since patient <PERSON_ID>4500356454715756250</PERSON_ID>'s second encounter in <CAREUNIT>4150077</CAREUNIT> on the current visit?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: Give the days elapsed since <PERSON_ID>4500356454715756250</PERSON_ID> had their second stay in <CAREUNIT>4150077</CAREUNIT> on this hospital visit.\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: What is the elapsed time in days since the second time <PERSON_ID>4500356454715756250</PERSON_ID> stayed in <CAREUNIT>4150077</CAREUNIT> during the ongoing hospital stay?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: How many full days since the second time <PERSON_ID>4500356454715756250</PERSON_ID> was admitted to <CAREUNIT>4150077</CAREUNIT> on this visit?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: From today, how many days ago was the second stay of <PERSON_ID>4500356454715756250</PERSON_ID> in <CAREUNIT>4150077</CAREUNIT> during the current hospitalization?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: What duration in days has passed since the second instance of patient <PERSON_ID>4500356454715756250</PERSON_ID> in careunit <CAREUNIT>4150077</CAREUNIT> this visit?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT visit_detail_start_date FROM (SELECT visit_detail_start_date FROM visit_detail WHERE person_id = 4500356454715756250 AND visit_detail_concept_id = 4150077 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 4500356454715756250) ORDER BY visit_detail_start_date OFFSET 1 LIMIT 1) AS second_visit) AS days_since_second_careunit_visit;"}
{"input": "Question: What are the top three frequent procedures of patients aged 50's on the first hospital visit?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: Which three procedures are most common for patients in their 50s during their first hospital stay?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: What are the three most frequent procedures undergone by patients aged 50 to 59 on their first hospital visit?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: List the top 3 procedures for patients aged in their 50s at the time of their initial hospital admission.\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: What procedures are most frequently performed for patients in their 50s on their first hospital visit?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: Can you list the top three procedures for patients aged between 50 and 59 during their initial hospitalization?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: Which procedures are most commonly recorded for patients in their 50s on their first visit to the hospital?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: What are the most frequent three procedures among 50-something patients during their first hospital stay?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: Identify the top 3 procedures for patients aged 50-59 on their first hospital admission.\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: What are the leading three procedures in patients aged in their fifties on first admission?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: Top three procedures for patients in their 50s on their first hospital encounter?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: What are the most common procedures among patients in their fifties on their first hospital visit?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: Tell me the three most performed procedures for 50-year-old patients on their first hospital stay.\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: Which are the top three procedures among patients aged 50s at the time of their first hospitalization?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: What are the most frequent three procedures received by patients in their 50s on their initial visit?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: List the top 3 most common procedures for patients aged between 50 and 59 on their first hospital visit.\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: What are the three top-used procedures for people aged 50-59 during their first hospital visit?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: Name the top three procedures conducted most often for patients aged in their 50s on first hospital contact.\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: Which procedures were most frequent in patients aged 50s during their initial hospitalization?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: What three procedures are most frequent among patients aged 50 to 59 on their first hospital visit?\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: Give the most common three procedures performed on patients aged in their 50s on first hospital entry.\n\nSQL:", "output": "SELECT procedure_concept_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE person_id IN (SELECT person_id FROM (SELECT person_id, EXTRACT(YEAR FROM visit_start_date) - year_of_birth AS age, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM (SELECT person_id, visit_start_date FROM visit_occurrence) v INNER JOIN (SELECT person_id, year_of_birth FROM person) p USING (person_id)) sub WHERE rn = 1 AND age BETWEEN 50 AND 59) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM (SELECT person_id, visit_occurrence_id, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY visit_start_date) AS rn FROM visit_occurrence) vo WHERE rn = 1) GROUP BY procedure_concept_id ORDER BY procedure_count DESC LIMIT 3;"}
{"input": "Question: What was the name of the measurement that patient <PERSON_ID>2185246955166355889</PERSON_ID> at 7:12:33 had on the first hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: Which measurement name was recorded for patient <PERSON_ID>2185246955166355889</PERSON_ID> at 7:12:33 during their first hospital stay?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: What measurement did patient <PERSON_ID>2185246955166355889</PERSON_ID> undergo at 7:12:33 on their first hospital admission?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: At 7:12:33, what was the name of the measurement for patient <PERSON_ID>2185246955166355889</PERSON_ID> during their initial hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: Name the measurement taken at 7:12:33 for patient <PERSON_ID>2185246955166355889</PERSON_ID> during the first hospital visit.\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: What was the title of the measurement done at 7:12:33 for patient <PERSON_ID>2185246955166355889</PERSON_ID> during their first hospital stay?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: Patient <PERSON_ID>2185246955166355889</PERSON_ID> had a measurement at 7:12:33 - what was its name during their first hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: During the first hospital admission, what measurement was recorded at 7:12:33 for patient <PERSON_ID>2185246955166355889</PERSON_ID>?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: Identify the measurement name for patient <PERSON_ID>2185246955166355889</PERSON_ID> taken at 7:12:33 on their first hospital visit.\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: What was the measurement called that was taken at 7:12:33 for patient <PERSON_ID>2185246955166355889</PERSON_ID> during their first hospital stay?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: Give the name of the measurement recorded at 7:12:33 during patient <PERSON_ID>2185246955166355889</PERSON_ID>'s first hospital visit.\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: What is the name of the measurement that was performed at 7:12:33 for patient <PERSON_ID>2185246955166355889</PERSON_ID> during their first admission?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: Which measurement was documented at 7:12:33 for patient <PERSON_ID>2185246955166355889</PERSON_ID> during their first hospital admission?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: What was the designation of the measurement for patient <PERSON_ID>2185246955166355889</PERSON_ID> taken at 7:12:33 during their initial hospital stay?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: Name the test performed on patient <PERSON_ID>2185246955166355889</PERSON_ID> at 7:12:33 on their first hospital visit.\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: At 7:12:33, which measurement was noted for patient <PERSON_ID>2185246955166355889</PERSON_ID> on their initial hospital admission?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: What measurement was conducted for patient <PERSON_ID>2185246955166355889</PERSON_ID> at 7:12:33 during their first hospital encounter?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: What was the label of the measurement at 7:12:33 for patient <PERSON_ID>2185246955166355889</PERSON_ID> on their first visit to the hospital?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: What measurement was logged at 7:12:33 for patient <PERSON_ID>2185246955166355889</PERSON_ID> on their first hospital stay?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: Can you name the measurement for patient <PERSON_ID>2185246955166355889</PERSON_ID> at 7:12:33 on their first hospital admission?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: What test name corresponds to the measurement done at 7:12:33 for patient <PERSON_ID>2185246955166355889</PERSON_ID> during their first hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS measurement_name FROM person p JOIN visit_occurrence vo ON p.person_id = vo.person_id JOIN measurement m ON m.person_id = p.person_id AND m.visit_occurrence_id = vo.visit_occurrence_id JOIN concept c ON m.measurement_concept_id = c.concept_id WHERE p.person_id = 2185246955166355889 AND m.measurement_datetime::time = '07:12:33' AND vo.visit_occurrence_id = (SELECT vo2.visit_occurrence_id FROM visit_occurrence vo2 WHERE vo2.person_id = p.person_id ORDER BY vo2.visit_start_datetime LIMIT 1);"}
{"input": "Question: Count the number of current patients.\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: How many patients are currently admitted?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: What is the number of patients still in the hospital?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: Give the count of current inpatients.\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: How many patients are currently staying in the hospital?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: What is the total number of patients currently admitted?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: Count how many patients are presently hospitalized.\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: How many individuals are still admitted to the hospital?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: Provide the count of patients currently under hospital care.\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: What's the number of patients currently in the hospital?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: Can you count the patients who haven't been discharged yet?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: How many patients have not yet left the hospital?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: What's the number of patients still undergoing treatment in the hospital?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: Count all the patients with ongoing hospital visits.\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: How many people are currently listed as inpatients?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: Give the number of patients who are still checked into the hospital.\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: Tell me how many patients are still present in the hospital.\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: What is the hospital's current inpatient count?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: Report the total of current hospital admissions.\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: How many hospital stays are still active?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: Number of patients currently being treated in the hospital?\n\nSQL:", "output": "SELECT COUNT(*) AS current_patient_count FROM (SELECT DISTINCT v.person_id FROM visit_occurrence v WHERE v.visit_end_date IS NULL AND v.discharge_to_concept_id IS NULL) AS current_patients;"}
{"input": "Question: Has there been any organism found in the first <MEASUREMENT>3007813</MEASUREMENT> microbiology test of patient <PERSON_ID>7776408132511994203</PERSON_ID> this month?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Was any organism detected in the first <MEASUREMENT>3007813</MEASUREMENT> microbiology test for patient <PERSON_ID>7776408132511994203</PERSON_ID> this month?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Did the first <MEASUREMENT>3007813</MEASUREMENT> microbiology result of patient <PERSON_ID>7776408132511994203</PERSON_ID> this month show any organism?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Have any organisms been found in patient <PERSON_ID>7776408132511994203</PERSON_ID>'s first <MEASUREMENT>3007813</MEASUREMENT> test this month?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: In the first <MEASUREMENT>3007813</MEASUREMENT> microbiology test for patient <PERSON_ID>7776408132511994203</PERSON_ID> this month, was an organism identified?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Has patient <PERSON_ID>7776408132511994203</PERSON_ID> shown any organism in the first <MEASUREMENT>3007813</MEASUREMENT> test this month?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Did the initial <MEASUREMENT>3007813</MEASUREMENT> test this month for patient <PERSON_ID>7776408132511994203</PERSON_ID> detect any organisms?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Any sign of an organism in the first <MEASUREMENT>3007813</MEASUREMENT> microbiology test for patient <PERSON_ID>7776408132511994203</PERSON_ID> this month?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Were organisms present in patient <PERSON_ID>7776408132511994203</PERSON_ID>'s first <MEASUREMENT>3007813</MEASUREMENT> microbiology result this month?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Has there been detection of any organism in the first <MEASUREMENT>3007813</MEASUREMENT> test this month for patient <PERSON_ID>7776408132511994203</PERSON_ID>?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Did the first <MEASUREMENT>3007813</MEASUREMENT> microbiology analysis of patient <PERSON_ID>7776408132511994203</PERSON_ID> this month find any organisms?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Was the first <MEASUREMENT>3007813</MEASUREMENT> test of patient <PERSON_ID>7776408132511994203</PERSON_ID> this month positive for organisms?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Did patient <PERSON_ID>7776408132511994203</PERSON_ID>'s first <MEASUREMENT>3007813</MEASUREMENT> microbiology test this month find any organisms?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Has the first <MEASUREMENT>3007813</MEASUREMENT> test this month revealed any organisms for patient <PERSON_ID>7776408132511994203</PERSON_ID>?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: In this month's first <MEASUREMENT>3007813</MEASUREMENT> test for patient <PERSON_ID>7776408132511994203</PERSON_ID>, has any organism been found?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Has an organism been detected this month in the first <MEASUREMENT>3007813</MEASUREMENT> microbiology test of patient <PERSON_ID>7776408132511994203</PERSON_ID>?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Was any microorganism identified in the first <MEASUREMENT>3007813</MEASUREMENT> microbiology test for patient <PERSON_ID>7776408132511994203</PERSON_ID> this month?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Is there any organism found in the first <MEASUREMENT>3007813</MEASUREMENT> test this month for patient <PERSON_ID>7776408132511994203</PERSON_ID>?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Has any organism shown up in the first <MEASUREMENT>3007813</MEASUREMENT> test for patient <PERSON_ID>7776408132511994203</PERSON_ID> this month?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Has the first <MEASUREMENT>3007813</MEASUREMENT> microbiology sample from patient <PERSON_ID>7776408132511994203</PERSON_ID> this month indicated an organism?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Was any organism found in patient <PERSON_ID>7776408132511994203</PERSON_ID>'s first <MEASUREMENT>3007813</MEASUREMENT> microbiology this month?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement me WHERE me.measurement_id = (SELECT measurement_id FROM (SELECT m.measurement_id, m.measurement_date FROM measurement m WHERE m.person_id = 7776408132511994203 AND m.measurement_concept_id = 3007813 AND date_trunc('month', m.measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY m.measurement_date ASC LIMIT 1) AS first_micro) AND me.value_as_concept_id IS NOT NULL) AS organism_found;"}
{"input": "Question: Is the <MEASUREMENT>3020891</MEASUREMENT> of patient <PERSON_ID>6333223435366125024</PERSON_ID> at 07:03:17 measured on the first ICU visit greater than the first value measured this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Was the <MEASUREMENT>3020891</MEASUREMENT> for patient <PERSON_ID>6333223435366125024</PERSON_ID> at 07:03:17 during the first ICU visit higher than the first value recorded this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: At 07:03:17, did patient <PERSON_ID>6333223435366125024</PERSON_ID> have a higher <MEASUREMENT>3020891</MEASUREMENT> in their first ICU stay than their first reading this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Is the <MEASUREMENT>3020891</MEASUREMENT> recorded at 07:03:17 for patient <PERSON_ID>6333223435366125024</PERSON_ID> on the first ICU visit greater than the first measurement this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Did the <MEASUREMENT>3020891</MEASUREMENT> of patient <PERSON_ID>6333223435366125024</PERSON_ID> at 07:03:17 on their first ICU visit exceed the first value measured this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: During their initial ICU stay, was the <MEASUREMENT>3020891</MEASUREMENT> of patient <PERSON_ID>6333223435366125024</PERSON_ID> at 07:03:17 higher than the year's first recorded value?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Was patient <PERSON_ID>6333223435366125024</PERSON_ID>'s <MEASUREMENT>3020891</MEASUREMENT> at 07:03:17 on the first ICU visit greater than the first measurement of this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: At 07:03:17, was the <MEASUREMENT>3020891</MEASUREMENT> for patient <PERSON_ID>6333223435366125024</PERSON_ID> during their first ICU stay more than the first value taken this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Was the <MEASUREMENT>3020891</MEASUREMENT> at 07:03:17 for patient <PERSON_ID>6333223435366125024</PERSON_ID> in the first ICU visit greater than the earliest measurement this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Is patient <PERSON_ID>6333223435366125024</PERSON_ID>'s <MEASUREMENT>3020891</MEASUREMENT> taken at 07:03:17 on their first ICU stay higher than the first value recorded this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Did the first ICU visit value of <MEASUREMENT>3020891</MEASUREMENT> at 07:03:17 for patient <PERSON_ID>6333223435366125024</PERSON_ID> exceed the first recorded value this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Was the <MEASUREMENT>3020891</MEASUREMENT> for patient <PERSON_ID>6333223435366125024</PERSON_ID> at 07:03:17 during the first ICU visit higher than the first value recorded this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: At 07:03:17, did patient <PERSON_ID>6333223435366125024</PERSON_ID> have a higher <MEASUREMENT>3020891</MEASUREMENT> in their first ICU stay than their first reading this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Is the <MEASUREMENT>3020891</MEASUREMENT> recorded at 07:03:17 for patient <PERSON_ID>6333223435366125024</PERSON_ID> on the first ICU visit greater than the first measurement this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Did the <MEASUREMENT>3020891</MEASUREMENT> of patient <PERSON_ID>6333223435366125024</PERSON_ID> at 07:03:17 on their first ICU visit exceed the first value measured this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: During their initial ICU stay, was the <MEASUREMENT>3020891</MEASUREMENT> of patient <PERSON_ID>6333223435366125024</PERSON_ID> at 07:03:17 higher than the year's first recorded value?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Was patient <PERSON_ID>6333223435366125024</PERSON_ID>'s <MEASUREMENT>3020891</MEASUREMENT> at 07:03:17 on the first ICU visit greater than the first measurement of this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: At 07:03:17, was the <MEASUREMENT>3020891</MEASUREMENT> for patient <PERSON_ID>6333223435366125024</PERSON_ID> during their first ICU stay more than the first value taken this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Was the <MEASUREMENT>3020891</MEASUREMENT> at 07:03:17 for patient <PERSON_ID>6333223435366125024</PERSON_ID> in the first ICU visit greater than the earliest measurement this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Is patient <PERSON_ID>6333223435366125024</PERSON_ID>'s <MEASUREMENT>3020891</MEASUREMENT> taken at 07:03:17 on their first ICU stay higher than the first value recorded this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Did the first ICU visit value of <MEASUREMENT>3020891</MEASUREMENT> at 07:03:17 for patient <PERSON_ID>6333223435366125024</PERSON_ID> exceed the first recorded value this year?\n\nSQL:", "output": "WITH icu_concepts AS (SELECT concept_id FROM concept WHERE domain_id = 'Visit' AND concept_name ILIKE '%intensive care%' AND standard_concept = 'S'), first_icu_visit AS (SELECT vd.visit_detail_id FROM visit_detail vd JOIN icu_concepts ic ON vd.visit_detail_concept_id = ic.concept_id WHERE vd.person_id = 6333223435366125024 ORDER BY vd.visit_detail_start_datetime LIMIT 1), icu_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_icu_visit icu ON m.visit_detail_id = icu.visit_detail_id WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND TO_CHAR(m.measurement_datetime, 'HH24:MI:SS') = '07:03:17' ORDER BY m.measurement_datetime LIMIT 1), first_year_measurement AS (SELECT m.value_as_number FROM measurement m WHERE m.person_id = 6333223435366125024 AND m.measurement_concept_id = 3020891 AND m.measurement_datetime >= DATE_TRUNC('year', CURRENT_DATE) ORDER BY m.measurement_datetime LIMIT 1) SELECT (icu.value_as_number > first.value_as_number) AS result FROM icu_measurement icu CROSS JOIN first_year_measurement first;"}
{"input": "Question: Has patient <PERSON_ID>1027943263163534509</PERSON_ID> received a <MEASUREMENT>3000620</MEASUREMENT> lab test since last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Did patient <PERSON_ID>1027943263163534509</PERSON_ID> undergo a <MEASUREMENT>3000620</MEASUREMENT> lab test since the beginning of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Has <PERSON_ID>1027943263163534509</PERSON_ID> been tested for <MEASUREMENT>3000620</MEASUREMENT> lab test from January 1st of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Was a <MEASUREMENT>3000620</MEASUREMENT> lab test starting at the beginning of the previous year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Did <PERSON_ID>1027943263163534509</PERSON_ID> receive the <MEASUREMENT>3000620</MEASUREMENT> lab test since the start of the last calendar year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Has patient <PERSON_ID>1027943263163534509</PERSON_ID> had a <MEASUREMENT>3000620</MEASUREMENT> lab test since the first day of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Was patient <PERSON_ID>1027943263163534509</PERSON_ID> subjected to a <MEASUREMENT>3000620</MEASUREMENT> lab test since January first of the previous year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Did patient <PERSON_ID>1027943263163534509</PERSON_ID> get tested with <MEASUREMENT>3000620</MEASUREMENT> lab test from the first day of the preceding year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Has patient <PERSON_ID>1027943263163534509</PERSON_ID> undergone testing for <MEASUREMENT>3000620</MEASUREMENT> lab test since the previous year's first day?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Did the patient <PERSON_ID>1027943263163534509</PERSON_ID> have a test for <MEASUREMENT>3000620</MEASUREMENT> lab test as of the beginning of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Did <PERSON_ID>1027943263163534509</PERSON_ID> receive the <MEASUREMENT>3000620</MEASUREMENT> lab test since the start of the last calendar year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Has patient <PERSON_ID>1027943263163534509</PERSON_ID> had a <MEASUREMENT>3000620</MEASUREMENT> lab test since the first day of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Was patient <PERSON_ID>1027943263163534509</PERSON_ID> subjected to a <MEASUREMENT>3000620</MEASUREMENT> lab test since January first of the previous year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Did patient <PERSON_ID>1027943263163534509</PERSON_ID> get tested with <MEASUREMENT>3000620</MEASUREMENT> lab test from the first day of the preceding year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Has patient <PERSON_ID>1027943263163534509</PERSON_ID> undergone testing for <MEASUREMENT>3000620</MEASUREMENT> lab test since the previous year's first day?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Did the patient <PERSON_ID>1027943263163534509</PERSON_ID> have a test for <MEASUREMENT>3000620</MEASUREMENT> lab test as of the beginning of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Did patient <PERSON_ID>1027943263163534509</PERSON_ID> undergo a <MEASUREMENT>3000620</MEASUREMENT> lab test since the beginning of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Has <PERSON_ID>1027943263163534509</PERSON_ID> been tested for <MEASUREMENT>3000620</MEASUREMENT> lab test from January 1st of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Did patient <PERSON_ID>1027943263163534509</PERSON_ID> undergo a <MEASUREMENT>3000620</MEASUREMENT> lab test starting from January 1st of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Was any <MEASUREMENT>3000620</MEASUREMENT> test performed on patient <PERSON_ID>1027943263163534509</PERSON_ID> at any time during the previous calendar year or later?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: Has patient <PERSON_ID>1027943263163534509</PERSON_ID> ever had a <MEASUREMENT>3000620</MEASUREMENT> lab result recorded starting from the beginning of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 1027943263163534509 AND m.measurement_concept_id = 3000620 AND m.measurement_date >= CURRENT_DATE - INTERVAL '1 year') AS has_received_lab_test;"}
{"input": "Question: What was the name of the lab test that patient 1359228978448708169 at 2141-03-05 18:48:41 received on the current hospital visit?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Can you tell me the name of the lab test performed on patient <PERSON_ID>1359228978448708169</PERSON_ID> at 2141-03-05 18:48:41 during their current hospital stay?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Which lab test was conducted for patient <PERSON_ID>1359228978448708169</PERSON_ID> on 2141-03-05 18:48:41 during their latest hospital visit?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: I need the name of the lab test done on patient <PERSON_ID>1359228978448708169</PERSON_ID> on March 5, 2141, at 6:48:41 PM in their ongoing hospital encounter.\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Identify the lab test patient <PERSON_ID>1359228978448708169</PERSON_ID> underwent at 6:48:41 PM on 05/03/2141 on this hospital admission.\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: What lab test was done for patient <PERSON_ID>1359228978448708169</PERSON_ID> on 2141-03-05 18:48:41 during their current hospitalization?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Please provide the name of the lab test given to patient <PERSON_ID>1359228978448708169</PERSON_ID> on 2141/03/05 at 18:48:41 during the current visit.\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Which laboratory test did patient <PERSON_ID>1359228978448708169</PERSON_ID> receive on 2141-03-05 18:48:41 during their current admission?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: At 2141-03-05 18:48:41, which lab test was ordered for patient <PERSON_ID>1359228978448708169</PERSON_ID> on their present hospital visit?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Tell me the name of the lab test that was recorded for patient <PERSON_ID>1359228978448708169</PERSON_ID> on 2141-03-05 18:48:41 during this hospital stay.\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Which lab exam did patient <PERSON_ID>1359228978448708169</PERSON_ID> receive as of 18:48:41 on the 5th of March, 2141 during this admission?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: For patient <PERSON_ID>1359228978448708169</PERSON_ID>, what was the lab test done on 2141-03-05 18:48:41 during the current visit?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Provide the lab test name that patient <PERSON_ID>1359228978448708169</PERSON_ID> got at precisely 18:48:41 on March 5th, 2141 in this hospital admission.\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: What was the laboratory test name for patient <PERSON_ID>1359228978448708169</PERSON_ID> at 2141-03-05 18:48:41 in their active hospital stay?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Can you identify the lab test for patient <PERSON_ID>1359228978448708169</PERSON_ID> done at 2141-03-05 18:48:41 on this visit?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: What is the name of the lab test patient <PERSON_ID>1359228978448708169</PERSON_ID> received on 2141-03-05 18:48:41 during their present encounter?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: I'd like to know the lab test name for patient <PERSON_ID>1359228978448708169</PERSON_ID> at 2141-03-05 18:48:41 in the current hospital visit.\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: What laboratory test was performed on patient <PERSON_ID>1359228978448708169</PERSON_ID> on 2141-03-05 18:48:41 during this encounter?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Fetch the name of the lab test that patient <PERSON_ID>1359228978448708169</PERSON_ID> received at 2141-03-05 18:48:41 during their current stay.\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Which lab investigation was done for patient <PERSON_ID>1359228978448708169</PERSON_ID> on 2141-03-05 18:48:41 in this hospital visit?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: Name the lab test administered to patient <PERSON_ID>1359228978448708169</PERSON_ID> at 2141-03-05 18:48:41 during their current admission.\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = m.measurement_concept_id) AS lab_test_name FROM measurement m WHERE m.person_id = 1359228978448708169 AND m.measurement_datetime = TIMESTAMP '2141-03-05 18:48:41' AND m.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 1359228978448708169 AND vo.visit_start_datetime <= TIMESTAMP '2141-03-05 18:48:41' ORDER BY vo.visit_start_datetime DESC LIMIT 1);"}
{"input": "Question: When was the last time that patient <PERSON_ID>4398308024184711278</PERSON_ID> was prescribed a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route last year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Can you tell me when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route in the previous calendar year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Do you know the date when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route during last year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: I'd like to find out when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route in the last year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Could you check when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route across the past year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Please find the last time that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route throughout the previous year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: At what date did that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route over the last calendar year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: What was the last occasion that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route for the entirety of last year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: When exactly was that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route at any point last year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Could you tell me the last occurrence that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route during the last full year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Find out when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route within the previous year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Let me know the time that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route sometime last year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Do we know the last instance that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route during the year before this one?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Tell me when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route in the year prior?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Identify the date when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route in the preceding year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Pinpoint the last time that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route in the 12 months before this year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Do you have the date when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route in the year gone by?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: I'd like to know the latest date when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route in the past complete year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Retrieve the last prescription date when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route through the course of last year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Give me the date when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route through the last year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: Track down when that patient <PERSON_ID>4398308024184711278</PERSON_ID> received a medication via <DRUG_ROUTE>4262914</DRUG_ROUTE> route in the last completed year?\n\nSQL:", "output": "SELECT MAX(de.drug_exposure_start_date) AS last_prescription_date FROM drug_exposure de WHERE de.person_id = 4398308024184711278 AND de.route_concept_id = 4262914 AND EXTRACT(YEAR FROM de.drug_exposure_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}
{"input": "Question: What are the top three frequent intake events since 3 months ago?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Which are the top three drugs in terms of intake frequency since three months ago?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: What are the three most common drugs administered in the past 3 months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: List the top three drug intake events during the last three months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Which are the top three drugs in terms of intake frequency over the past 3 months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Which three medications were prescribed the most within the previous three months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Identify the top three frequent drug uses from the last 3 months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Which are the top three drugs in terms of intake frequency for the past three months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Show me the top 3 drug intake cases in the last quarter?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Which are the top three drugs in terms of intake frequency in the last 90 days?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Give me the top three most frequent drug intakes over the previous 3 months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Which are the top three drugs in terms of intake frequency since the last 3 months began?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Which are the top 3 drugs with the most intake events within the last 3 months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Which are the top three drugs in terms of intake frequency from three months back?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Highlight the top three medications given in the time span of three months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Which are the top three drugs in terms of intake frequency within the recent 3 months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Find the three drugs taken most often starting three months ago?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Which three drugs were consumed most counting from three months ago?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Give a list of the top three drug exposure events during the prior 3 months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: What are the leading three drug consumption events since approximately 90 days ago?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Which are the top three drugs in terms of intake frequency in the course of the last three months?\n\nSQL:", "output": "SELECT de.drug_concept_id, c.concept_name, COUNT(*) AS intake_count FROM drug_exposure de JOIN concept c ON de.drug_concept_id = c.concept_id WHERE de.drug_exposure_start_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY de.drug_concept_id, c.concept_name ORDER BY intake_count DESC LIMIT 3;"}
{"input": "Question: Has the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been ever less than 154 since 5 day ago?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Has there ever been a <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been found to be lower than 154 since five days back?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Has the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> ever dropped below 154 within the last 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Was the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> measured at less than 154 within the last 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Has the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been documented below 154 in the last 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Can we confirm the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> fallen below 154 in the previous 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Did the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been recorded under 154 over the past five days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Have we observed the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been documented below 154 since 5 day ago?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Was the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> measured at less than 154 in the previous 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Was the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> fallen below 154 in the previous 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Has the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been documented below 154 in the last 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Did the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been documented below 154 during the past 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Is there a record where the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been documented below 154 in the previous 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Has there ever been a <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> ever shown a value below 154 over the previous 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Was the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been ever less than 154 in the previous 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Has there ever been a <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> ever shown a value below 154 since five days back?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Was the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> ever dropped below 154 within the last 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Do records show the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been ever less than 154 from 5 days ago to now?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Have we observed the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been documented below 154 in the last 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Can we confirm the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been found to be lower than 154 in the last five-day period?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: Did the <MEASUREMENT>3025315</MEASUREMENT> of patient <PERSON_ID>2277671307213519503</PERSON_ID> been noted as less than 154 in the last 5 days?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM measurement m WHERE m.person_id = 2277671307213519503 AND m.measurement_concept_id = 3025315 AND m.value_as_number < 154 AND m.measurement_datetime >= CURRENT_DATE - INTERVAL '5 days');"}
{"input": "Question: What are the top five frequent specimens that patients were tested within the same month after having received a <PROCEDURE>4300757</PROCEDURE> procedure on the current hospital visit?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are 5 top specimens that patients underwent testing up to one month after having received a <PROCEDURE>4300757</PROCEDURE> procedure in the context of the same hospital admission?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are five top specimens that patients were tested in the month following having received a <PROCEDURE>4300757</PROCEDURE> procedure during their hospital stay?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are the most frequent 5 specimens that patients underwent testing in the same calendar month after having received a <PROCEDURE>4300757</PROCEDURE> procedure in the context of the same hospital admission?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are the most frequent five specimens that patients got tested in the month following having received a <PROCEDURE>4300757</PROCEDURE> procedure while still in the hospital?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are the top 5 specimens that patients have been tested up to one month after having received a <PROCEDURE>4300757</PROCEDURE> procedure while still in the hospital?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are the 5 most frequently observed specimens that patients have been tested within a month after having received a <PROCEDURE>4300757</PROCEDURE> procedure during their hospital stay?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are 5 most common specimens that patients had samples taken during the same month as having received a <PROCEDURE>4300757</PROCEDURE> procedure during their hospital stay?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are five top specimens that patients got tested in the same calendar month after having received a <PROCEDURE>4300757</PROCEDURE> procedure on the same admission?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are the five most frequently observed specimens that patients had samples taken in the same calendar month after having received a <PROCEDURE>4300757</PROCEDURE> procedure during their hospital stay?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are five top specimens that patients were tested during the same month as having received a <PROCEDURE>4300757</PROCEDURE> procedure during their hospital stay?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are 5 most common specimens that patients got tested within a month after having received a <PROCEDURE>4300757</PROCEDURE> procedure while still in the hospital?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are the 5 most frequently observed specimens that patients had samples taken up to one month after having received a <PROCEDURE>4300757</PROCEDURE> procedure on the same admission?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are five most common specimens that patients got tested up to one month after having received a <PROCEDURE>4300757</PROCEDURE> procedure on the same admission?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are 5 most common specimens that patients had samples taken up to one month after having received a <PROCEDURE>4300757</PROCEDURE> procedure during that hospital visit?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are the top five specimens that patients underwent testing up to one month after having received a <PROCEDURE>4300757</PROCEDURE> procedure on the same admission?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are five top specimens that patients got tested in the same calendar month after having received a <PROCEDURE>4300757</PROCEDURE> procedure while still in the hospital?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are the five most frequently observed specimens that patients were tested in the month following having received a <PROCEDURE>4300757</PROCEDURE> procedure while still in the hospital?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are the most frequent 5 specimens that patients were tested within a month after having received a <PROCEDURE>4300757</PROCEDURE> procedure during that hospital visit?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are the five most frequently observed specimens that patients were tested during the same month as having received a <PROCEDURE>4300757</PROCEDURE> procedure in the context of the same hospital admission?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: What are the 5 most frequently observed specimens that patients have been tested during the same month as having received a <PROCEDURE>4300757</PROCEDURE> procedure during that hospital visit?\n\nSQL:", "output": "SELECT specimen_name, COUNT(*) AS frequency FROM (SELECT (SELECT concept_name FROM concept c WHERE c.concept_id = s.specimen_concept_id) AS specimen_name FROM specimen s WHERE s.person_id IN (SELECT vo.person_id FROM visit_occurrence vo WHERE vo.visit_end_date IS NULL AND vo.discharged_to_concept_id IS NULL AND vo.visit_start_date = (SELECT MAX(visit_start_date) FROM visit_occurrence vo_inner WHERE vo_inner.person_id = vo.person_id AND vo_inner.visit_end_date IS NULL AND vo_inner.discharged_to_concept_id IS NULL) AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.visit_occurrence_id = vo.visit_occurrence_id AND po.procedure_concept_id = 4300757 AND s.specimen_date BETWEEN po.procedure_date AND (po.procedure_date + INTERVAL '1 month')))) AS specimen_names GROUP BY specimen_name ORDER BY frequency DESC LIMIT 5;"}
{"input": "Question: Has patient <PERSON_ID>6264555136921102118</PERSON_ID> been prescribed <DRUG>40173098</DRUG> on the first ICU visit?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Did patient <PERSON_ID>6264555136921102118</PERSON_ID> receive <DRUG>40173098</DRUG> during their first intensive care unit stay?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Was <DRUG>40173098</DRUG> administered to patient <PERSON_ID>6264555136921102118</PERSON_ID> at the first critical care unit admission?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Was <DRUG>40173098</DRUG> prescribed for patient <PERSON_ID>6264555136921102118</PERSON_ID> on their initial intensive care ward visit?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: At the first ICU department stay, did patient <PERSON_ID>6264555136921102118</PERSON_ID> receive <DRUG>40173098</DRUG>?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Was patient <PERSON_ID>6264555136921102118</PERSON_ID> given <DRUG>40173098</DRUG> during the first intensive therapy unit encounter?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Was <DRUG>40173098</DRUG> given to patient <PERSON_ID>6264555136921102118</PERSON_ID> at the time of their first ICU section visit?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Did patient <PERSON_ID>6264555136921102118</PERSON_ID> get <DRUG>40173098</DRUG> during the first intensive unit admission?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Was <DRUG>40173098</DRUG> included in patient <PERSON_ID>6264555136921102118</PERSON_ID>'s treatment during their first critical unit stay?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Was patient <PERSON_ID>6264555136921102118</PERSON_ID> prescribed <DRUG>40173098</DRUG> at their first intensive care admission?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: During the first critical care ward visit, did patient <PERSON_ID>6264555136921102118</PERSON_ID> take <DRUG>40173098</DRUG>?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Did the first intensive care unit stay for patient <PERSON_ID>6264555136921102118</PERSON_ID> involve a prescription of <DRUG>40173098</DRUG>?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: On the initial critical care unit admission, was <DRUG>40173098</DRUG> prescribed to patient <PERSON_ID>6264555136921102118</PERSON_ID>?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Was <DRUG>40173098</DRUG> part of the treatment for patient <PERSON_ID>6264555136921102118</PERSON_ID> in the first intensive care ward encounter?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Was <DRUG>40173098</DRUG> ordered for patient <PERSON_ID>6264555136921102118</PERSON_ID> during their first ICU department stay?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Has patient <PERSON_ID>6264555136921102118</PERSON_ID> received <DRUG>40173098</DRUG> on the initial intensive therapy unit admission?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Was there any administration of <DRUG>40173098</DRUG> to patient <PERSON_ID>6264555136921102118</PERSON_ID> on the first ICU section visit?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Has <DRUG>40173098</DRUG> been ordered for patient <PERSON_ID>6264555136921102118</PERSON_ID> during their first intensive unit stay?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Was <DRUG>40173098</DRUG> used in patient <PERSON_ID>6264555136921102118</PERSON_ID>'s first critical unit treatment?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Was <DRUG>40173098</DRUG> part of the first intensive ward therapy for patient <PERSON_ID>6264555136921102118</PERSON_ID>?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: Has patient <PERSON_ID>6264555136921102118</PERSON_ID> taken <DRUG>40173098</DRUG> during the initial critical care ward encounter?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 6264555136921102118 AND de.drug_concept_id = 40173098 AND de.visit_occurrence_id = (SELECT vd.visit_occurrence_id FROM visit_detail vd WHERE vd.person_id = 6264555136921102118 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_date LIMIT 1));"}
{"input": "Question: How many hours have passed since patient <PERSON_ID>1832753164987106308</PERSON_ID> was admitted to the icu currently?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: What is the number of hours since patient <PERSON_ID>1832753164987106308</PERSON_ID> was admitted to the intensive care unit?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: How long has it been in hours since patient <PERSON_ID>1832753164987106308</PERSON_ID> entered the icu ward?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: Can you tell me how many hours ago patient <PERSON_ID>1832753164987106308</PERSON_ID> was admitted to the critical care unit?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: How much time in hours has passed since patient <PERSON_ID>1832753164987106308</PERSON_ID> was taken into intensive care department care?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: Since when, in hours, has patient <PERSON_ID>1832753164987106308</PERSON_ID> been in the icu section?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: How many hours ago was patient <PERSON_ID>1832753164987106308</PERSON_ID> admitted to the intensive unit?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: What's the elapsed time in hours since patient <PERSON_ID>1832753164987106308</PERSON_ID> entered the critical unit?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: Could you compute the hours since intensive care area admission for patient <PERSON_ID>1832753164987106308</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: How many hours has patient <PERSON_ID>1832753164987106308</PERSON_ID> spent in the icu facility so far?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: Tell me the number of hours passed since intensive therapy unit admission for patient <PERSON_ID>1832753164987106308</PERSON_ID>.\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: When was patient <PERSON_ID>1832753164987106308</PERSON_ID> admitted to the intensive care unit, in hours ago?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: How many hours have elapsed since the icu ward admission of patient <PERSON_ID>1832753164987106308</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: Time passed in hours since critical care unit admission of patient <PERSON_ID>1832753164987106308</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: From now, how many hours ago did patient <PERSON_ID>1832753164987106308</PERSON_ID> go into intensive care department?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: What is the total time in hours since the patient <PERSON_ID>1832753164987106308</PERSON_ID> was admitted to icu section?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: How many hours have gone by since intensive unit intake of patient <PERSON_ID>1832753164987106308</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: Can you tell how many hours patient <PERSON_ID>1832753164987106308</PERSON_ID> has been in the critical unit now?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: What's the duration in hours since patient <PERSON_ID>1832753164987106308</PERSON_ID> was brought into intensive care area?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: How long in hours has patient <PERSON_ID>1832753164987106308</PERSON_ID> been hospitalized in icu facility?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: What is the current time in hours since intensive therapy unit admission of patient <PERSON_ID>1832753164987106308</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - vd.visit_detail_start_datetime)) / 3600 AS hours_since_icu_admission FROM visit_detail vd WHERE vd.person_id = 1832753164987106308 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1;"}
{"input": "Question: How many days have passed since patient <PERSON_ID>3493108529686372660</PERSON_ID> was admitted to the hospital currently?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: What is the number of days since patient <PERSON_ID>3493108529686372660</PERSON_ID> was admitted to the hospital?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: How long has it been in days since patient <PERSON_ID>3493108529686372660</PERSON_ID> entered the hospital?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: Can you tell me how many days ago patient <PERSON_ID>3493108529686372660</PERSON_ID> was admitted to the hospital?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: How much time in days has passed since patient <PERSON_ID>3493108529686372660</PERSON_ID> was taken into the hospital?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: Since when, in days, has patient <PERSON_ID>3493108529686372660</PERSON_ID> been in the hospital?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: How many days ago was patient <PERSON_ID>3493108529686372660</PERSON_ID> admitted to the hospital?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: What's the elapsed time in days since patient <PERSON_ID>3493108529686372660</PERSON_ID> entered the hospital?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: Could you compute the days since hospital admission for patient <PERSON_ID>3493108529686372660</PERSON_ID>?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: How many days has patient <PERSON_ID>3493108529686372660</PERSON_ID> spent in the hospital so far?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: Tell me the number of days passed since hospital admission for patient <PERSON_ID>3493108529686372660</PERSON_ID>.\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: When was patient <PERSON_ID>3493108529686372660</PERSON_ID> admitted to the hospital, in days ago?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: How many days have elapsed since the hospital admission of patient <PERSON_ID>3493108529686372660</PERSON_ID>?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: Time passed in days since hospital admission of patient <PERSON_ID>3493108529686372660</PERSON_ID>?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: From now, how many days ago did patient <PERSON_ID>3493108529686372660</PERSON_ID> go into the hospital?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: What is the total time in days since the patient <PERSON_ID>3493108529686372660</PERSON_ID> was admitted to the hospital?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: How many days have gone by since hospital intake of patient <PERSON_ID>3493108529686372660</PERSON_ID>?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: Can you tell how many days patient <PERSON_ID>3493108529686372660</PERSON_ID> has been in the hospital now?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: What's the duration in days since patient <PERSON_ID>3493108529686372660</PERSON_ID> was brought into the hospital?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: How long in days has patient <PERSON_ID>3493108529686372660</PERSON_ID> been hospitalized?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: What is the current time in days since hospital admission of patient <PERSON_ID>3493108529686372660</PERSON_ID>?\n\nSQL:", "output": "SELECT CURRENT_DATE - (SELECT v.visit_start_date FROM visit_occurrence v WHERE v.person_id = 3493108529686372660 ORDER BY v.visit_start_date DESC LIMIT 1) AS days_since_admission;"}
{"input": "Question: What were the top three frequent lab tests that patients had within the same icu visit after having been diagnosed with <CONDITION>4229440</CONDITION> until 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: Which three lab tests were most commonly performed during the same ICU visit after a diagnosis of <CONDITION>4229440</CONDITION> until 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: What are the top 3 lab tests frequently ordered after diagnosis with <CONDITION>4229440</CONDITION> during the same ICU stay up to 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: Can you list the three most frequent lab tests within the same ICU visit after <CONDITION>4229440</CONDITION> diagnosis before 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: Top three lab tests done most often during ICU visits following diagnosis of <CONDITION>4229440</CONDITION> up until 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: What were the three most frequently ordered lab tests in the ICU after being diagnosed with <CONDITION>4229440</CONDITION> prior to the year 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: Identify the 3 most frequent lab tests post-diagnosis of <CONDITION>4229440</CONDITION> within ICU visits until 2203.\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: What are the top three most performed lab tests in ICU following <CONDITION>4229440</CONDITION> diagnosis, before 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: List the top three frequent labs ordered in ICU post diagnosis of <CONDITION>4229440</CONDITION> until 2203.\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: What were the 3 most ordered lab tests within ICU for patients diagnosed with <CONDITION>4229440</CONDITION> up to 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: Could you tell me the top 3 lab tests frequently conducted during ICU stays after <CONDITION>4229440</CONDITION> diagnosis, until 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: Which were the most frequent three lab tests for ICU patients after a diagnosis of <CONDITION>4229440</CONDITION> until 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: Top 3 lab tests most often performed in ICU after patients got diagnosed with <CONDITION>4229440</CONDITION> up to 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: Which top 3 lab tests appeared most often in ICU for patients with <CONDITION>4229440</CONDITION> before 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: Provide the top three ICU lab tests post <CONDITION>4229440</CONDITION> diagnosis before year 2203.\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: What were the three lab tests with highest frequency during ICU stay following <CONDITION>4229440</CONDITION> diagnosis up to 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: List top three lab tests done during ICU visit after diagnosis with <CONDITION>4229440</CONDITION> before 2203.\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: Which 3 lab tests were mostly used in ICU visits after <CONDITION>4229440</CONDITION> diagnosis before 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: Name the three lab tests most frequently performed in ICU after <CONDITION>4229440</CONDITION> diagnosis by 2203.\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: What are the top 3 most common lab tests in ICU visits after <CONDITION>4229440</CONDITION> diagnosis until 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: What were the leading three lab tests given in ICU after a diagnosis of <CONDITION>4229440</CONDITION> before the year 2203?\n\nSQL:", "output": "SELECT c.concept_name AS lab_test_name, COUNT(*) AS test_count FROM condition_occurrence AS co JOIN visit_detail AS vd ON co.visit_detail_id = vd.visit_detail_id JOIN concept AS icu_concept ON vd.visit_detail_concept_id = icu_concept.concept_id AND icu_concept.concept_name ILIKE '%intensive care%' JOIN measurement AS m ON m.visit_detail_id = vd.visit_detail_id AND m.measurement_date >= co.condition_start_date AND m.measurement_date < DATE '2204-01-01' JOIN concept AS c ON m.measurement_concept_id = c.concept_id WHERE co.condition_concept_id = 4229440 GROUP BY c.concept_name ORDER BY test_count DESC LIMIT 3;"}
{"input": "Question: What is the maximum monthly number of patient records diagnosed with <CONDITION>316135</CONDITION> on the first ICU visit?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: What is the highest monthly count of patients diagnosed with <CONDITION>316135</CONDITION> during their first critical care unit stay?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: Which month had the most patients diagnosed with <CONDITION>316135</CONDITION> on initial ICU admission?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: At what monthly maximum were patients first diagnosed with <CONDITION>316135</CONDITION> in the intensive therapy unit?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: What is the peak number of monthly diagnoses of <CONDITION>316135</CONDITION> during the first intensive care unit visit?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: What was the top monthly count of cases for <CONDITION>316135</CONDITION> on a first intensive care unit visit?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: What is the highest number of <CONDITION>316135</CONDITION> diagnoses recorded in a single month during first intensive therapy unit stays?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: Which month recorded the maximum number of patients with <CONDITION>316135</CONDITION> at their first intensive therapy unit admission?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: What is the monthly peak of patients diagnosed with <CONDITION>316135</CONDITION> during initial ICU visits?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: Find the month with the most initial ICU patients diagnosed with <CONDITION>316135</CONDITION>.\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: During which month were the most first-time ICU patients diagnosed with <CONDITION>316135</CONDITION>?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: What's the monthly maximum for critical care unit-first-visit diagnoses of <CONDITION>316135</CONDITION>?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: Identify the highest monthly incidence of <CONDITION>316135</CONDITION> on first intensive therapy unit visits.\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: What was the largest monthly group diagnosed with <CONDITION>316135</CONDITION> during their initial intensive therapy unit admission?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: When was the highest number of <CONDITION>316135</CONDITION> diagnoses during first intensive care unit encounters?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: What is the greatest monthly count of first ICU visit patients with <CONDITION>316135</CONDITION>?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: Which month saw the highest number of patients newly diagnosed with <CONDITION>316135</CONDITION> in intensive care unit?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: In which month did the number of new intensive therapy unit patients with <CONDITION>316135</CONDITION> reach its maximum?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: How many patients at most were diagnosed with <CONDITION>316135</CONDITION> monthly on their first ICU stay?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: What's the month with the most <CONDITION>316135</CONDITION> diagnoses for first-time critical care unit patients?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: When was the peak in first intensive therapy unit visit diagnoses of <CONDITION>316135</CONDITION>?\n\nSQL:", "output": "WITH intensive_care_concepts AS (SELECT concept_id FROM concept WHERE concept_name ILIKE '%intensive care%'), intensive_care_visits AS (SELECT vd.person_id, vd.visit_detail_id, vd.visit_detail_start_datetime, vd.visit_detail_end_datetime, DATE_TRUNC('month', vd.visit_detail_start_datetime) AS visit_month, ROW_NUMBER() OVER (PARTITION BY vd.person_id ORDER BY vd.visit_detail_start_datetime) AS rn FROM visit_detail vd WHERE vd.visit_detail_concept_id IN (SELECT concept_id FROM intensive_care_concepts)), first_icu_visits_with_condition AS (SELECT icv.person_id, icv.visit_month FROM intensive_care_visits icv JOIN condition_occurrence co ON co.person_id = icv.person_id AND co.condition_concept_id = 316135 AND co.condition_start_datetime BETWEEN icv.visit_detail_start_datetime AND icv.visit_detail_end_datetime WHERE icv.rn = 1) SELECT MAX(monthly_count) AS max_monthly_patients FROM (SELECT visit_month, COUNT(DISTINCT person_id) AS monthly_count FROM first_icu_visits_with_condition GROUP BY visit_month) AS monthly_counts;"}
{"input": "Question: What was the name of the drug that patient <PERSON_ID>4252323938379886649</PERSON_ID> was prescribed within 3 months after having received a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Give me the name of the drug was recorded for patient <PERSON_ID>4252323938379886649</PERSON_ID> in the 3 months following a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Which medication was started for patient <PERSON_ID>4252323938379886649</PERSON_ID> up to 3 months after a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Give me the name of the drug the patient was treated with <PERSON_ID>4252323938379886649</PERSON_ID> within 3 months of a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Identify the drug was given to patient <PERSON_ID>4252323938379886649</PERSON_ID> after, within 3 months a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: List the drug was prescribed to patient <PERSON_ID>4252323938379886649</PERSON_ID> after, within 3 months a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Please find the drug name was given to patient <PERSON_ID>4252323938379886649</PERSON_ID> within 3 months of a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Retrieve the drug was administered to patient <PERSON_ID>4252323938379886649</PERSON_ID> within 3 months of a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Do you know the drug name the patient was put on <PERSON_ID>4252323938379886649</PERSON_ID> over the 3 months after a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Can you tell me which drug was prescribed to patient <PERSON_ID>4252323938379886649</PERSON_ID> in the three months post a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Can you tell me which drug the patient was treated with <PERSON_ID>4252323938379886649</PERSON_ID> in the 3 months immediately after a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Which medication was recorded for patient <PERSON_ID>4252323938379886649</PERSON_ID> during the 3-month period after a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Which medication was prescribed to patient <PERSON_ID>4252323938379886649</PERSON_ID> within the next 3 months after a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Retrieve the drug was initiated for patient <PERSON_ID>4252323938379886649</PERSON_ID> in the three months that followed a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Which medication was administered to patient <PERSON_ID>4252323938379886649</PERSON_ID> within 3 months of a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Retrieve the drug was given to patient <PERSON_ID>4252323938379886649</PERSON_ID> in the 3 months immediately after a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: I need to know the drug name was given to patient <PERSON_ID>4252323938379886649</PERSON_ID> within 3 months of a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Retrieve the drug was given to patient <PERSON_ID>4252323938379886649</PERSON_ID> during the 3-month period after a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Can you tell me which drug was administered to patient <PERSON_ID>4252323938379886649</PERSON_ID> after, within 3 months a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Retrieve the drug the patient was put on <PERSON_ID>4252323938379886649</PERSON_ID> after, within 3 months a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: Please find the drug name was started for patient <PERSON_ID>4252323938379886649</PERSON_ID> during the 3-month period after a <PROCEDURE>4275142</PROCEDURE> procedure since September/2210?\n\nSQL:", "output": "SELECT c.concept_name FROM concept c WHERE c.concept_id IN (SELECT de.drug_concept_id FROM drug_exposure de WHERE de.person_id = 4252323938379886649 AND EXISTS (SELECT 1 FROM procedure_occurrence po WHERE po.person_id = 4252323938379886649 AND po.procedure_concept_id = 4275142 AND po.procedure_date >= DATE '2210-09-01' AND de.drug_exposure_start_date BETWEEN po.procedure_date AND po.procedure_date + INTERVAL '3 months'));"}
{"input": "Question: How many hours have passed since the second to last time patient <PERSON_ID>1233743921983070633</PERSON_ID> had a <DRUG>46275446</DRUG> intake on the current icu visit?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: How much time has elapsed in hours since the the one-before-last intake of <DRUG>46275446</DRUG> on the current icu stay of patient <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: What is the time in hours since the the drug event prior to the last for <DRUG>46275446</DRUG> that occurred in the ICU stay currently in progress for <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: What is the time in hours since the the drug dose before the latest of <DRUG>46275446</DRUG> while the patient <PERSON_ID>1233743921983070633</PERSON_ID> was in the current ICU visit?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: How many hours have gone by since the the drug event prior to the last for <DRUG>46275446</DRUG> that occurred in the ICU stay currently in progress for <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: How many hours have gone by since the the second latest dose of <DRUG>46275446</DRUG> while the patient <PERSON_ID>1233743921983070633</PERSON_ID> was in the current ICU visit?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: How much time has elapsed in hours since the the dose just before the last of <DRUG>46275446</DRUG> that patient <PERSON_ID>1233743921983070633</PERSON_ID> received in their present icu stay?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: How many hours have gone by since the the second latest dose of <DRUG>46275446</DRUG> administered during the ongoing icu visit to <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: Can you tell me how many hours have passed since the the administration preceding the last for <DRUG>46275446</DRUG> from the present ICU encounter of <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: Can you tell me how many hours have passed since the the drug dose before the latest of <DRUG>46275446</DRUG> that was recorded in the current icu visit for <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: Tell me the number of hours since the the drug event prior to the last for <DRUG>46275446</DRUG> during the current intensive care visit of <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: How many hours have gone by since the the second to last administration of <DRUG>46275446</DRUG> that patient <PERSON_ID>1233743921983070633</PERSON_ID> received in their present icu stay?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: How many hours have gone by since the the dose just before the last of <DRUG>46275446</DRUG> during the current intensive care visit of <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: How many hours ago did the the administration preceding the last for <DRUG>46275446</DRUG> on the current icu stay of patient <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: How much time has elapsed in hours since the the penultimate administration of <DRUG>46275446</DRUG> that patient <PERSON_ID>1233743921983070633</PERSON_ID> received in their present icu stay?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: Please calculate how many hours it's been since the the administration preceding the last for <DRUG>46275446</DRUG> logged during this ICU stay for patient <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: In hours, how long has it been since the the one-before-last intake of <DRUG>46275446</DRUG> logged during this ICU stay for patient <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: Can you tell me how many hours have passed since the the second most recent intake of <DRUG>46275446</DRUG> while the patient <PERSON_ID>1233743921983070633</PERSON_ID> was in the current ICU visit?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: How many hours have gone by since the the drug event prior to the last for <DRUG>46275446</DRUG> that occurred in the ICU stay currently in progress for <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: What is the hourly duration since the the intake before the last one of <DRUG>46275446</DRUG> that occurred in the ICU stay currently in progress for <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: How much time has elapsed in hours since the the second most recent intake of <DRUG>46275446</DRUG> that occurred in the ICU stay currently in progress for <PERSON_ID>1233743921983070633</PERSON_ID>?\n\nSQL:", "output": "SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT drug_exposure_start_datetime FROM (SELECT de.drug_exposure_start_datetime FROM drug_exposure de WHERE de.person_id = 1233743921983070633 AND de.drug_concept_id = 46275446 AND de.visit_detail_id = (SELECT vd.visit_detail_id FROM visit_detail vd WHERE vd.person_id = 1233743921983070633 AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%' AND c.domain_id = 'Visit') ORDER BY vd.visit_detail_start_datetime DESC LIMIT 1) ORDER BY de.drug_exposure_start_datetime DESC OFFSET 1 LIMIT 1) AS second_last_intake))) / 3600 AS hours_since_second_last_intake;"}
{"input": "Question: Has patient <PERSON_ID>873643486446280759</PERSON_ID> been prescribed any medication on the first hospital visit?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Was there any prescription for patient <PERSON_ID>873643486446280759</PERSON_ID> received any prescribed drugs on the first hospital encounter?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Can you confirm if patient <PERSON_ID>873643486446280759</PERSON_ID> was prescribed any drugs during their first hospital admission?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Did the records show that patient <PERSON_ID>873643486446280759</PERSON_ID> was prescribed something on the first hospitalisation?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Was any medication prescribed to patient <PERSON_ID>873643486446280759</PERSON_ID> received any prescriptions on their first hospital stay?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Has the patient <PERSON_ID>873643486446280759</PERSON_ID> was prescribed something on the first hospitalisation?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Did patient <PERSON_ID>873643486446280759</PERSON_ID> had any drugs ordered during their first hospital stay?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Was there any prescription for patient <PERSON_ID>873643486446280759</PERSON_ID> was given any medication on their initial hospital visit?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Was patient <PERSON_ID>873643486446280759</PERSON_ID> had any medicine prescribed on their first hospital record?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Did the records show that patient <PERSON_ID>873643486446280759</PERSON_ID> was prescribed something on the first hospitalisation?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Can you confirm if patient <PERSON_ID>873643486446280759</PERSON_ID> was issued any prescription on their first visit to the hospital?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Was the patient <PERSON_ID>873643486446280759</PERSON_ID> was issued any prescription on their first visit to the hospital?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Can you confirm if patient <PERSON_ID>873643486446280759</PERSON_ID> was administered any medications during the first hospital visit?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Was any medication prescribed to patient <PERSON_ID>873643486446280759</PERSON_ID> was given any medication on their initial hospital visit?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Was the patient <PERSON_ID>873643486446280759</PERSON_ID> had any medicine prescribed on their first hospital record?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Did the records show that patient <PERSON_ID>873643486446280759</PERSON_ID> was prescribed something on the first hospitalisation?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Was the patient <PERSON_ID>873643486446280759</PERSON_ID> had medication prescribed on the first hospital visit?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Was any medication prescribed to patient <PERSON_ID>873643486446280759</PERSON_ID> received any prescribed drugs on the first hospital encounter?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Do we know if patient <PERSON_ID>873643486446280759</PERSON_ID> was administered any medications during the first hospital visit?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Was patient <PERSON_ID>873643486446280759</PERSON_ID> was prescribed any drugs during their first hospital admission?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Was the patient <PERSON_ID>873643486446280759</PERSON_ID> was issued any prescription on their first visit to the hospital?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM drug_exposure de WHERE de.person_id = 873643486446280759 AND de.visit_occurrence_id = (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 873643486446280759 ORDER BY vo.visit_start_date ASC LIMIT 1)) AS prescribed_on_first_visit;"}
{"input": "Question: Count the number of icu visits of patient <PERSON_ID>6114769255486634735</PERSON_ID> this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Total number of intensive care visits for patient <PERSON_ID>6114769255486634735</PERSON_ID> has been admitted into ICU this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Calculate the ICU encounters for patient <PERSON_ID>6114769255486634735</PERSON_ID> went through this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Get the number of intensive care stays for patient <PERSON_ID>6114769255486634735</PERSON_ID> was admitted to this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: How many ICU visits has patient <PERSON_ID>6114769255486634735</PERSON_ID> has had this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Please count the ICU stays for patient <PERSON_ID>6114769255486634735</PERSON_ID> has been admitted into ICU this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Number of ICU-related visits by patient <PERSON_ID>6114769255486634735</PERSON_ID> has had this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Get the number of intensive care stays for patient <PERSON_ID>6114769255486634735</PERSON_ID> had throughout the year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Total number of intensive care visits for patient <PERSON_ID>6114769255486634735</PERSON_ID> has undergone in the current year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Number of ICU-related visits by patient <PERSON_ID>6114769255486634735</PERSON_ID> was admitted to this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Report how many ICU visits patient <PERSON_ID>6114769255486634735</PERSON_ID> has experienced this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Can you tell me how many ICU visits patient <PERSON_ID>6114769255486634735</PERSON_ID> has been admitted into ICU this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Number of ICU-related visits by patient <PERSON_ID>6114769255486634735</PERSON_ID> has been in ICU over the past year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Can you tell me how many ICU visits patient <PERSON_ID>6114769255486634735</PERSON_ID> has been in ICU over the past year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Report how many ICU visits patient <PERSON_ID>6114769255486634735</PERSON_ID> had during this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Number of ICU-related visits by patient <PERSON_ID>6114769255486634735</PERSON_ID> had during this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Can you tell me how many ICU visits patient <PERSON_ID>6114769255486634735</PERSON_ID> was admitted to this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Total number of intensive care visits for patient <PERSON_ID>6114769255486634735</PERSON_ID> was admitted to this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Get the number of intensive care stays for patient <PERSON_ID>6114769255486634735</PERSON_ID> recorded in the current year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Give me the count of ICU visits for patient <PERSON_ID>6114769255486634735</PERSON_ID> went through this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: Give me the count of ICU visits for patient <PERSON_ID>6114769255486634735</PERSON_ID> was admitted to this year.\n\nSQL:", "output": "SELECT COUNT(*) AS icu_visit_count FROM visit_detail vd WHERE vd.person_id = 6114769255486634735 AND EXTRACT(YEAR FROM vd.visit_detail_start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND vd.visit_detail_concept_id IN (SELECT c.concept_id FROM concept c WHERE c.concept_name ILIKE '%intensive care%');"}
{"input": "Question: What was the total amount of dose of <DRUG>942384</DRUG> that patient <PERSON_ID>3552656871579492299</PERSON_ID> were prescribed since yesterday?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: What's the total quantity of <DRUG>942384</DRUG> did patient <PERSON_ID>3552656871579492299</PERSON_ID> receive starting from yesterday?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: Give me the total prescribed dose of <DRUG>942384</DRUG> was prescribed to patient <PERSON_ID>3552656871579492299</PERSON_ID> since yesterday?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: Report the overall prescribed dose of <DRUG>942384</DRUG> did the patient get <PERSON_ID>3552656871579492299</PERSON_ID> since one day ago?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: How much of <DRUG>942384</DRUG> was administered to patient <PERSON_ID>3552656871579492299</PERSON_ID> in the last day?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: Give me the total prescribed dose of <DRUG>942384</DRUG> was administered to patient <PERSON_ID>3552656871579492299</PERSON_ID> since one day ago?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: How many units of <DRUG>942384</DRUG> did the patient get <PERSON_ID>3552656871579492299</PERSON_ID> over the last 24 hours?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: Provide the sum of the dosage for <DRUG>942384</DRUG> was prescribed to patient <PERSON_ID>3552656871579492299</PERSON_ID> in the past 24 hours?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: Give me the total prescribed dose of <DRUG>942384</DRUG> was assigned to patient <PERSON_ID>3552656871579492299</PERSON_ID> since the previous day?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: What total dosage of <DRUG>942384</DRUG> was administered to patient <PERSON_ID>3552656871579492299</PERSON_ID> in the last day?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: How much of <DRUG>942384</DRUG> was taken by patient <PERSON_ID>3552656871579492299</PERSON_ID> over the last 24 hours?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: What total dosage of <DRUG>942384</DRUG> was taken by patient <PERSON_ID>3552656871579492299</PERSON_ID> over the last 24 hours?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: How many units of <DRUG>942384</DRUG> was dispensed to patient <PERSON_ID>3552656871579492299</PERSON_ID> from yesterday until now?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: How many units of <DRUG>942384</DRUG> was recorded for patient <PERSON_ID>3552656871579492299</PERSON_ID> in the last day?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: Provide the sum of the dosage for <DRUG>942384</DRUG> was ordered for patient <PERSON_ID>3552656871579492299</PERSON_ID> from the last calendar day?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: Calculate the total dose of <DRUG>942384</DRUG> did the patient get <PERSON_ID>3552656871579492299</PERSON_ID> from the last calendar day?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: What total dosage of <DRUG>942384</DRUG> was taken by patient <PERSON_ID>3552656871579492299</PERSON_ID> starting from yesterday?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: What is the cumulative dose of <DRUG>942384</DRUG> was taken by patient <PERSON_ID>3552656871579492299</PERSON_ID> from the last calendar day?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: Calculate the total dose of <DRUG>942384</DRUG> was taken by patient <PERSON_ID>3552656871579492299</PERSON_ID> in the time since yesterday?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: Report the overall prescribed dose of <DRUG>942384</DRUG> was given to patient <PERSON_ID>3552656871579492299</PERSON_ID> from yesterday until now?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: Tell me the total amount prescribed for <DRUG>942384</DRUG> was ordered for patient <PERSON_ID>3552656871579492299</PERSON_ID> in the time since yesterday?\n\nSQL:", "output": "SELECT SUM(de.quantity) AS total_quantity, de.dose_unit_source_value FROM drug_exposure de WHERE de.person_id = 3552656871579492299 AND de.drug_concept_id = 942384 AND de.drug_exposure_start_date >= current_date - INTERVAL '1 day' GROUP BY de.dose_unit_source_value;"}
{"input": "Question: What was the organism name found in the second to last <MEASUREMENT>4036044</MEASUREMENT> microbiology test of patient <PERSON_ID>517101686241972750</PERSON_iD> this month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Can you tell me the organism detected in the <MEASUREMENT>4036044</MEASUREMENT> taken before the most recent from patient <PERSON_ID>517101686241972750</PERSON_iD> in the current month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Name the organism found in the next-to-last <MEASUREMENT>4036044</MEASUREMENT> test for patient <PERSON_ID>517101686241972750</PERSON_iD> from this month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: What is the name of the organism found in the <MEASUREMENT>4036044</MEASUREMENT> test done before last for patient <PERSON_ID>517101686241972750</PERSON_iD> this month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: What is the name of the organism found in the next-to-last <MEASUREMENT>4036044</MEASUREMENT> test for patient <PERSON_ID>517101686241972750</PERSON_iD> this current month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Name the organism found in the second latest <MEASUREMENT>4036044</MEASUREMENT> of patient <PERSON_ID>517101686241972750</PERSON_iD> since the beginning of this month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Report the organism discovered in the prior to last <MEASUREMENT>4036044</MEASUREMENT> microbiology test performed on patient <PERSON_ID>517101686241972750</PERSON_iD> over the past month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: What is the name of the organism found in the prior to last <MEASUREMENT>4036044</MEASUREMENT> microbiology test performed on patient <PERSON_ID>517101686241972750</PERSON_iD> since the beginning of this month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Can you tell me the organism detected in the next-to-last <MEASUREMENT>4036044</MEASUREMENT> test for patient <PERSON_ID>517101686241972750</PERSON_iD> this current month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: What is the name of the organism found in the <MEASUREMENT>4036044</MEASUREMENT> just before the last for patient <PERSON_ID>517101686241972750</PERSON_iD> for this calendar month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: What is the name of the organism found in the next-to-last <MEASUREMENT>4036044</MEASUREMENT> test for patient <PERSON_ID>517101686241972750</PERSON_iD> since the beginning of this month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Report the organism discovered in the second most recent <MEASUREMENT>4036044</MEASUREMENT> analysis for patient <PERSON_ID>517101686241972750</PERSON_iD> this month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Which microbe was found in the <MEASUREMENT>4036044</MEASUREMENT> sample taken before the latest from patient <PERSON_ID>517101686241972750</PERSON_iD> for this calendar month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: What organism appeared in the second latest <MEASUREMENT>4036044</MEASUREMENT> of patient <PERSON_ID>517101686241972750</PERSON_iD> for this calendar month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: What is the name of the organism found in the prior to last <MEASUREMENT>4036044</MEASUREMENT> microbiology test performed on patient <PERSON_ID>517101686241972750</PERSON_iD> from this month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Report the organism discovered in the <MEASUREMENT>4036044</MEASUREMENT> just before the last for patient <PERSON_ID>517101686241972750</PERSON_iD> in the ongoing month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Can you tell me the organism detected in the <MEASUREMENT>4036044</MEASUREMENT> just before the last for patient <PERSON_ID>517101686241972750</PERSON_iD> in the ongoing month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Which bacterium was found in the prior to last <MEASUREMENT>4036044</MEASUREMENT> microbiology test performed on patient <PERSON_ID>517101686241972750</PERSON_iD> during the current month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Report the organism discovered in the next-to-last <MEASUREMENT>4036044</MEASUREMENT> test for patient <PERSON_ID>517101686241972750</PERSON_iD> in the ongoing month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: What organism appeared in the <MEASUREMENT>4036044</MEASUREMENT> test done before last for patient <PERSON_ID>517101686241972750</PERSON_iD> for this calendar month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: What was the detected organism in the <MEASUREMENT>4036044</MEASUREMENT> just before the last for patient <PERSON_ID>517101686241972750</PERSON_iD> since the beginning of this month?\n\nSQL:", "output": "SELECT me.value_as_concept_id, (SELECT c.concept_name FROM concept c WHERE c.concept_id = me.value_as_concept_id) AS organism_name FROM measurement me WHERE me.person_id = 517101686241972750 AND me.measurement_concept_id = 4036044 AND date_trunc('month', me.measurement_date) = date_trunc('month', CURRENT_DATE) AND me.measurement_datetime = (SELECT measurement_datetime FROM (SELECT measurement_datetime FROM measurement WHERE person_id = 517101686241972750 AND measurement_concept_id = 4036044 AND date_trunc('month', measurement_date) = date_trunc('month', CURRENT_DATE) ORDER BY measurement_datetime DESC OFFSET 1 LIMIT 1) sub);"}
{"input": "Question: Count the number of current patients aged 20's\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Give me the count of patients currently aged in their 20s staying in the hospital.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: How many patients aged 20 to 29 are currently admitted in ongoing visits.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: How many patients aged 20 to 29 are currently admitted currently in the facility.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Determine the number of current patients aged in the 20s group without discharge record.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Determine the number of current patients aged in the 20s group under current care.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Determine the number of current patients aged in the 20s group\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Count all currently admitted patients in their 20s staying in the hospital.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Give me the count of patients currently aged in their 20s currently in the facility.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Report the count of active patients aged in their twenties currently in the facility.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Find how many patients in their twenties are currently in hospital\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Count all currently admitted patients in their 20s\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Determine the number of current patients aged in the 20s group\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Find how many patients in their twenties are currently in hospital\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Determine the number of current patients aged in the 20s group at the moment.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Find how many patients in their twenties are currently in hospital\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: What is the number of current patients who are in their twenties at the moment.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: What is the number of current patients who are in their twenties in ongoing visits.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Total number of present patients aged between 20 and 29 in the current admission phase.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Count all currently admitted patients in their 20s without discharge record.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: What is the number of current patients who are in their twenties staying in the hospital.\n\nSQL:", "output": "SELECT COUNT(*) AS num_current_patients_in_20s FROM person p WHERE DATE_PART('year', AGE(CURRENT_DATE, p.birth_datetime)) BETWEEN 20 AND 29 AND EXISTS (SELECT 1 FROM visit_occurrence v WHERE v.person_id = p.person_id AND v.visit_end_date IS NULL);"}
{"input": "Question: Count the number of hospital visits of patient <PERSON_ID>3024811265145791153</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: How many times did patient <PERSON_ID>3024811265145791153</PERSON_ID> visit the hospital last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Number of hospital admissions for patient <PERSON_ID>3024811265145791153</PERSON_ID> in the past year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Total hospital visits by patient <PERSON_ID>3024811265145791153</PERSON_ID> last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Last year's hospital visit count for patient <PERSON_ID>3024811265145791153</PERSON_ID>?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Hospital encounters of patient <PERSON_ID>3024811265145791153</PERSON_ID> during last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Can you count how many hospital stays patient <PERSON_ID>3024811265145791153</PERSON_ID> had last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: How many inpatient or outpatient visits did <PERSON_ID>3024811265145791153</PERSON_ID> have last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Determine the number of times patient <PERSON_ID>3024811265145791153</PERSON_ID> was hospitalized last year.\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: What is the number of hospital visits for <PERSON_ID>3024811265145791153</PERSON_ID> last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Fetch count of hospital encounters for patient <PERSON_ID>3024811265145791153</PERSON_ID> during last year.\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Give me the number of hospital visits for <PERSON_ID>3024811265145791153</PERSON_ID> in the previous year.\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Patient <PERSON_ID>3024811265145791153</PERSON_ID> hospital visit total for the last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: In the last calendar year, how many times did <PERSON_ID>3024811265145791153</PERSON_ID> go to the hospital?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Record of hospitalizations for <PERSON_ID>3024811265145791153</PERSON_ID> over the last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Annual hospital visit count for <PERSON_ID>3024811265145791153</PERSON_ID> last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: How frequently did <PERSON_ID>3024811265145791153</PERSON_ID> have hospital visits last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Could you list the number of visits to hospital by <PERSON_ID>3024811265145791153</PERSON_ID> last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: What was the total number of hospital admissions for <PERSON_ID>3024811265145791153</PERSON_ID> in the last year?\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Please tell me how many times <PERSON_ID>3024811265145791153</PERSON_ID> was admitted last year.\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: Tell me the number of hospital contacts <PERSON_ID>3024811265145791153</PERSON_ID> had in the past year.\n\nSQL:", "output": "SELECT COUNT(*) AS visit_count_last_year FROM visit_occurrence vo WHERE vo.person_id = 3024811265145791153 AND DATE_PART('year', vo.visit_start_date) = DATE_PART('year', CURRENT_DATE) - 1;"}
{"input": "Question: What is the intake method of <DRUG>711588</DRUG>?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: How is <DRUG>711588</DRUG> administered?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: What route is used to take <DRUG>711588</DRUG>?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: What is the method of administration for <DRUG>711588</DRUG>?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: Through which route is <DRUG>711588</DRUG> taken?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: How do patients take <DRUG>711588</DRUG>?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: How should <DRUG>711588</DRUG> be administered?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: What is the route of administration for <DRUG>711588</DRUG>?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: Can you tell me how <DRUG>711588</DRUG> is given?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: What intake route is used for <DRUG>711588</DRUG>?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: How is <DRUG>711588</DRUG> delivered to the patient?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: Which method is used to give <DRUG>711588</DRUG>?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: Please provide the administration route of <DRUG>711588</DRUG>.\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: What is the delivery route for <DRUG>711588</DRUG>?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: In what way is <DRUG>711588</DRUG> administered?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: What is the intake route for <DRUG>711588</DRUG>?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: Tell me the administration method for <DRUG>711588</DRUG>.\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: How is the drug <DRUG>711588</DRUG> typically taken?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: By what method is <DRUG>711588</DRUG> administered?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: What route of administration is associated with <DRUG>711588</DRUG>?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: How is <DRUG>711588</DRUG> introduced into the body?\n\nSQL:", "output": "SELECT (SELECT c.concept_name FROM concept c WHERE c.concept_id = d.route_concept_id) AS intake_method FROM drug_exposure d WHERE d.drug_concept_id = 711588 AND d.route_concept_id IS NOT NULL LIMIT 1;"}
{"input": "Question: Count the number of patients who received a <PROCEDURE>4056681</PROCEDURE> procedure two_times today.\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: How many patients underwent a <PROCEDURE>4056681</PROCEDURE> procedure twice today?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Number of patients who had a <PROCEDURE>4056681</PROCEDURE> procedure done two times today?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: How many people received a <PROCEDURE>4056681</PROCEDURE> procedure exactly two times today?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Count patients who went through <PROCEDURE>4056681</PROCEDURE> procedure two times today.\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Total number of patients that had <PROCEDURE>4056681</PROCEDURE> done twice today?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Patients with exactly two <PROCEDURE>4056681</PROCEDURE> procedures today?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Identify how many patients received <PROCEDURE>4056681</PROCEDURE> procedure two times today.\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: How many patients had <PROCEDURE>4056681</PROCEDURE> performed on them twice today?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Give me the count of patients with two <PROCEDURE>4056681</PROCEDURE> procedures today.\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Determine how many patients got <PROCEDURE>4056681</PROCEDURE> twice today.\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Find number of individuals who had <PROCEDURE>4056681</PROCEDURE> procedure two times today.\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: What's the number of patients who had two <PROCEDURE>4056681</PROCEDURE> procedures today?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Today, how many patients underwent <PROCEDURE>4056681</PROCEDURE> exactly twice?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Number of patients today with two <PROCEDURE>4056681</PROCEDURE> entries?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: How many times was <PROCEDURE>4056681</PROCEDURE> done on the same patient twice today?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Patients who had <PROCEDURE>4056681</PROCEDURE> two times on today's date?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Count of patients that received <PROCEDURE>4056681</PROCEDURE> procedure two times today?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: How many patients got a double dose of <PROCEDURE>4056681</PROCEDURE> today?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Today, how many different patients had <PROCEDURE>4056681</PROCEDURE> performed two times?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: Can you count the patients who had <PROCEDURE>4056681</PROCEDURE> twice today?\n\nSQL:", "output": "SELECT COUNT(*) AS patient_count FROM (SELECT person_id FROM (SELECT person_id, COUNT(*) AS procedure_count FROM procedure_occurrence WHERE procedure_concept_id = 4056681 AND procedure_date = CURRENT_DATE GROUP BY person_id) AS proc_counts WHERE procedure_count = 2) AS patients_with_two_procedures;"}
{"input": "Question: What is the change in the <MEASUREMENT>3027018</MEASUREMENT> of patient <PERSON_ID>5753387128065316976<PERSON_ID> from the first value measured on the first hospital visit compared to the second value measured on the last ICU visit?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: For patient <PERSON_ID>5753387128065316976<PERSON_ID>, what is the difference in <MEASUREMENT>3027018</MEASUREMENT> between the first value on their first hospital visit and the second value on their last ICU visit?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: Please provide the change in <MEASUREMENT>3027018</MEASUREMENT> for patient <PERSON_ID>5753387128065316976<PERSON_ID> from the first value measured on the initial hospital visit to the second value measured during the last ICU stay.\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: What is the change in the <MEASUREMENT>3027018</MEASUREMENT> of patient <PERSON_ID>5753387128065316976<PERSON_ID> from the first value measured on the first hospital visit compared to the second value measured on the last ICU visit?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: How did the <MEASUREMENT>3027018</MEASUREMENT> of patient <PERSON_ID>5753387128065316976<PERSON_ID> change from the first measurement on their first hospital visit to the second measurement on their last ICU visit?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: What difference can be observed in the <MEASUREMENT>3027018</MEASUREMENT> of patient <PERSON_ID>5753387128065316976<PERSON_ID> between the first value during the first hospital stay and the second value during the last ICU stay?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: Compare the first measurement taken during the first hospital visit and the second measurement taken during the last ICU stay for <MEASUREMENT>3027018</MEASUREMENT> of patient <PERSON_ID>5753387128065316976<PERSON_ID>.\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: How does the second value measured during the last ICU visit compare to the first value from the first hospital visit for <MEASUREMENT>3027018</MEASUREMENT> in patient <PERSON_ID>5753387128065316976<PERSON_ID>?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: Determine the change in <MEASUREMENT>3027018</MEASUREMENT> for patient <PERSON_ID>5753387128065316976<PERSON_ID> between the first value on their first hospital admission and the second value from their last ICU stay.\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: What is the variation in <MEASUREMENT>3027018</MEASUREMENT> of patient <PERSON_ID>5753387128065316976<PERSON_ID> from the earliest hospital value to the second measurement on the most recent ICU visit?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: Provide the change in <MEASUREMENT>3027018</MEASUREMENT> from the first measured value during the patient's initial hospital visit to the second value measured during their last ICU stay for <PERSON_ID>5753387128065316976<PERSON_ID>.\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: What is the measured difference in <MEASUREMENT>3027018</MEASUREMENT> between the first value during the first hospital visit and the second value during the last ICU stay for patient <PERSON_ID>5753387128065316976<PERSON_ID>?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: How much did the <MEASUREMENT>3027018</MEASUREMENT> change from the first measurement in the initial hospital stay to the second measurement in the final ICU visit for patient <PERSON_ID>5753387128065316976<PERSON_ID>?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: Find the change in <MEASUREMENT>3027018</MEASUREMENT> between the first value on the first hospital visit and the second value on the last ICU visit for patient <PERSON_ID>5753387128065316976<PERSON_ID>.\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: How has the <MEASUREMENT>3027018</MEASUREMENT> evolved for patient <PERSON_ID>5753387128065316976<PERSON_ID> from their first measurement during the initial hospital admission to the second value measured in the last ICU stay?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: Show the difference in <MEASUREMENT>3027018</MEASUREMENT> between the first value recorded in the patient's first hospital visit and the second one recorded in the last ICU visit for <PERSON_ID>5753387128065316976<PERSON_ID>.\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: Can you compute the difference in <MEASUREMENT>3027018</MEASUREMENT> for patient <PERSON_ID>5753387128065316976<PERSON_ID> between the first hospital measurement and the second one taken during the last ICU stay?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: Report the difference between the first measured value during the first hospital stay and the second measurement during the last ICU visit for <MEASUREMENT>3027018</MEASUREMENT> in patient <PERSON_ID>5753387128065316976<PERSON_ID>.\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: How did the <MEASUREMENT>3027018</MEASUREMENT> for patient <PERSON_ID>5753387128065316976</PERSON_ID> change between the initial measurement taken during their first hospital admission and the second measurement recorded during their final ICU stay?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: What difference is observed in the <MEASUREMENT>3027018</MEASUREMENT> of patient <PERSON_ID>5753387128065316976</PERSON_ID> when comparing the first recorded value from the patientâ€™s initial hospital visit with the second recorded value from their last ICU visit?\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: Compare the <MEASUREMENT>3027018</MEASUREMENT> of patient <PERSON_ID>5753387128065316976</PERSON_ID> between the first measurement during their earliest hospital encounter and the second measurement taken during their most recent ICU stay.\n\nSQL:", "output": "WITH hospital_visits AS (SELECT vo.visit_occurrence_id, vo.person_id, vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 5753387128065316976), first_hospital_visit AS (SELECT visit_occurrence_id FROM hospital_visits ORDER BY visit_start_datetime LIMIT 1), first_measurement AS (SELECT m.value_as_number FROM measurement m JOIN first_hospital_visit fhv ON m.visit_occurrence_id = fhv.visit_occurrence_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime LIMIT 1), icu_visits AS (SELECT vd.visit_detail_id, vd.visit_detail_start_datetime FROM visit_detail vd JOIN concept c ON vd.visit_detail_concept_id = c.concept_id WHERE vd.person_id = 5753387128065316976 AND c.concept_name ILIKE '%intensive care%'), last_icu_visit AS (SELECT visit_detail_id FROM icu_visits ORDER BY visit_detail_start_datetime DESC LIMIT 1), icu_measurements AS (SELECT m.value_as_number, m.measurement_datetime FROM measurement m JOIN last_icu_visit liv ON m.visit_detail_id = liv.visit_detail_id WHERE m.person_id = 5753387128065316976 AND m.measurement_concept_id = 3027018 ORDER BY m.measurement_datetime), second_icu_measurement AS (SELECT value_as_number FROM icu_measurements OFFSET 1 LIMIT 1) SELECT f.value_as_number AS first_hospital_value, s.value_as_number AS second_icu_value, s.value_as_number - f.value_as_number AS value_difference FROM first_measurement f, second_icu_measurement s;"}
{"input": "Question: What are the top three frequent specimens that patients were tested within 14 days after having been diagnosed with <CONDITION>441258</CONDITION> since last month?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Which three specimens were most commonly collected within 14 days after patients were diagnosed with <CONDITION>441258</CONDITION> since last month?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Since last month, what are the top 3 specimen types patients were tested for within two weeks after being diagnosed with <CONDITION>441258</CONDITION>?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Following a diagnosis of <CONDITION>441258</CONDITION> since last month, what are the three most frequently collected specimens within 14 days?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Identify the top three specimens most often tested within 14 days of a <CONDITION>441258</CONDITION> diagnosis since last month.\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Among patients diagnosed with <CONDITION>441258</CONDITION> since last month, which three specimen types were most frequently obtained in the following 14 days?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: What are the 3 most common specimens collected within 14 days after patients received a <CONDITION>441258</CONDITION> diagnosis since last month?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Name the top three types of specimens tested in patients within 14 days of being diagnosed with <CONDITION>441258</CONDITION> since last month.\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Which specimens were most frequently tested in the first two weeks after <CONDITION>441258</CONDITION> diagnosis since last month?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: After patients were diagnosed with <CONDITION>441258</CONDITION> in the past month, which 3 specimen types were tested most often within 14 days?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: What are the leading three specimen types sampled within 14 days following a <CONDITION>441258</CONDITION> diagnosis since last month?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Which are the top three specimens collected shortly after a <CONDITION>441258</CONDITION> diagnosis (within 14 days) since last month?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: List the 3 most tested specimen types within 14 days after a diagnosis of <CONDITION>441258</CONDITION> since last month.\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: What were the top three specimens patients were most frequently tested for, within 14 days post-diagnosis of <CONDITION>441258</CONDITION> in the last month?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Among those diagnosed with <CONDITION>441258</CONDITION> since last month, which specimens were most frequently tested within 14 days?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Since last month, which three specimen types have been tested most often within two weeks after diagnosis of <CONDITION>441258</CONDITION>?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: What are the top three specimens collected within two weeks after a <CONDITION>441258</CONDITION> diagnosis during the last month?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: In patients diagnosed with <CONDITION>441258</CONDITION> since last month, which specimens were most commonly sampled within the next 14 days?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Provide the top three specimen names most frequently tested within 14 days of <CONDITION>441258</CONDITION> diagnosis since the previous month.\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Which three specimens were most often analyzed within 14 days post-diagnosis of <CONDITION>441258</CONDITION> over the last month?\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: Name the top 3 specimen categories frequently tested in the 14-day window following <CONDITION>441258</CONDITION> diagnosis since last month.\n\nSQL:", "output": "WITH condition_occurrence_filtered AS (SELECT co.person_id, co.condition_start_date FROM condition_occurrence co WHERE co.condition_concept_id = 441258 AND co.condition_start_date >= date_trunc('month', CURRENT_DATE) - INTERVAL '1 month'), specimen_within_14_days AS (SELECT s.specimen_concept_id, s.person_id, s.specimen_date FROM specimen s JOIN condition_occurrence_filtered cof ON s.person_id = cof.person_id AND s.specimen_date BETWEEN cof.condition_start_date AND cof.condition_start_date + INTERVAL '14 days') SELECT s.specimen_concept_id, c.concept_name AS specimen_name, COUNT(*) AS frequency FROM specimen_within_14_days s JOIN concept c ON s.specimen_concept_id = c.concept_id GROUP BY s.specimen_concept_id, c.concept_name ORDER BY frequency DESC LIMIT 3;"}
{"input": "Question: How many days have passed since the second time patient <PERSON_ID>7767928252036371506</PERSON_ID> was prescribed <DRUG>1308877</DRUG> on the current hospital visit?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: What is the number of days since the 2nd time patient <PERSON_ID>7767928252036371506</PERSON_ID> received <DRUG>1308877</DRUG> during their current hospital visit?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: How long has it been since the 2nd prescription of <DRUG>1308877</DRUG> for patient <PERSON_ID>7767928252036371506</PERSON_ID> during the ongoing hospital stay?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: How many days ago was the 2nd administration of <DRUG>1308877</DRUG> to patient <PERSON_ID>7767928252036371506</PERSON_ID> on this hospital visit?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: Since the second time patient <PERSON_ID>7767928252036371506</PERSON_ID> was given <DRUG>1308877</DRUG> on their current visit, how many days have passed?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: What is the time in days since patient <PERSON_ID>7767928252036371506</PERSON_ID> was prescribed <DRUG>1308877</DRUG> for the second time during this visit?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: Can you tell me how many days have gone by since the second prescription of <DRUG>1308877</DRUG> for patient <PERSON_ID>7767928252036371506</PERSON_ID> on the current stay?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: How many days passed since patient <PERSON_ID>7767928252036371506</PERSON_ID> was given <DRUG>1308877</DRUG> for the second time in this hospital visit?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: What is the duration in days since patient <PERSON_ID>7767928252036371506</PERSON_ID> had their second dose of <DRUG>1308877</DRUG> on the current visit?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: How long (in days) ago did patient <PERSON_ID>7767928252036371506</PERSON_ID> receive <DRUG>1308877</DRUG> for the second time during this hospitalization?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: Since the 2nd instance of prescribing <DRUG>1308877</DRUG> to patient <PERSON_ID>7767928252036371506</PERSON_ID>, how many days have gone by (on the current visit)?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: Tell me how many days have elapsed since patient <PERSON_ID>7767928252036371506</PERSON_ID>'s second administration of <DRUG>1308877</DRUG> during this hospital visit.\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: What is the count of days since the second time <DRUG>1308877</DRUG> was given to patient <PERSON_ID>7767928252036371506</PERSON_ID> on the current visit?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: When was the 2nd time patient <PERSON_ID>7767928252036371506</PERSON_ID> was prescribed <DRUG>1308877</DRUG> during this stay, and how many days since then?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: Count the days since the second time <DRUG>1308877</DRUG> was administered to patient <PERSON_ID>7767928252036371506</PERSON_ID> during this visit.\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: How much time in days has passed since the second prescription of <DRUG>1308877</DRUG> during the current hospital stay for patient <PERSON_ID>7767928252036371506</PERSON_ID>?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: Could you provide the number of days since patient <PERSON_ID>7767928252036371506</PERSON_ID> had their second dose of <DRUG>1308877</DRUG> during this hospital visit?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: What is the elapsed time in days since patient <PERSON_ID>7767928252036371506</PERSON_ID> got their second prescription of <DRUG>1308877</DRUG> during the current visit?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: Give the number of days that have passed since patient <PERSON_ID>7767928252036371506</PERSON_ID> received <DRUG>1308877</DRUG> for the second time on this admission.\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: How many calendar days have passed since the second time <DRUG>1308877</DRUG> was prescribed to patient <PERSON_ID>7767928252036371506</PERSON_ID> during their current hospital visit?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: How long has passed since patient <PERSON_ID>7767928252036371506</PERSON_ID> was prescribed <DRUG>1308877</DRUG> for the second time in this admission (in days)?\n\nSQL:", "output": "WITH patient_visits AS (SELECT vo.visit_occurrence_id FROM visit_occurrence vo WHERE vo.person_id = 7767928252036371506 ORDER BY vo.visit_start_date DESC LIMIT 1), drug_orders AS (SELECT de.drug_exposure_start_date, ROW_NUMBER() OVER (ORDER BY de.drug_exposure_start_date) AS rn FROM drug_exposure de JOIN patient_visits pv ON de.visit_occurrence_id = pv.visit_occurrence_id WHERE de.person_id = 7767928252036371506 AND de.drug_concept_id = 1308877), second_drug_exposure AS (SELECT drug_exposure_start_date FROM drug_orders WHERE rn = 2) SELECT CURRENT_DATE - sde.drug_exposure_start_date AS days_since_second_exposure FROM second_drug_exposure sde;"}
{"input": "Question: What was the last hospital admission type of patient <PERSON_ID>395982632653845924</PERSON_ID> until last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: What hospital visit type did patient <PERSON_ID>395982632653845924</PERSON_ID> prior to this year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: What was the most recent hospital admission type for patient <PERSON_ID>395982632653845924</PERSON_ID> before January this year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: Which hospital admission type did patient <PERSON_ID>395982632653845924</PERSON_ID> before January this year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: Determine the last recorded hospital admission type for patient <PERSON_ID>395982632653845924</PERSON_ID> until the end of last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: What admission type was recorded last for patient <PERSON_ID>395982632653845924</PERSON_ID> before January this year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: What kind of hospital visit did patient <PERSON_ID>395982632653845924</PERSON_ID> before the start of this year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: What was the most recent hospital admission type for patient <PERSON_ID>395982632653845924</PERSON_ID> before the start of this year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: Can you tell me the last hospital admission category for patient <PERSON_ID>395982632653845924</PERSON_ID> until the end of last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: What admission type was recorded last for patient <PERSON_ID>395982632653845924</PERSON_ID> until last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: What type of hospital visit was the last one for patient <PERSON_ID>395982632653845924</PERSON_ID> until last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: Which hospital admission type did patient <PERSON_ID>395982632653845924</PERSON_ID> until the end of last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: Identify the final hospital admission type of patient <PERSON_ID>395982632653845924</PERSON_ID> prior to this year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: Which hospital admission type did patient <PERSON_ID>395982632653845924</PERSON_ID> prior to this year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: Can you tell me the last hospital admission category for patient <PERSON_ID>395982632653845924</PERSON_ID> until last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: What was the most recent hospital admission type for patient <PERSON_ID>395982632653845924</PERSON_ID> up to last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: What was the last type of hospital admission for patient <PERSON_ID>395982632653845924</PERSON_ID> up to the end of last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: Which hospital admission type did patient <PERSON_ID>395982632653845924</PERSON_ID> up to last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: What was the most recent hospital admission type for patient <PERSON_ID>395982632653845924</PERSON_ID> up to last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: What kind of hospital visit did patient <PERSON_ID>395982632653845924</PERSON_ID> until last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: Can you tell me the last hospital admission category for patient <PERSON_ID>395982632653845924</PERSON_ID> until the end of last year?\n\nSQL:", "output": "SELECT c.concept_name FROM visit_occurrence vo JOIN concept c ON vo.visit_concept_id = c.concept_id WHERE vo.person_id = 395982632653845924 AND vo.visit_start_date < DATE_TRUNC('year', CURRENT_DATE) ORDER BY vo.visit_start_date DESC LIMIT 1;"}
{"input": "Question: When was the second to last hospital admission time of patient <PERSON_ID>8621568400785831320</PERSON_ID> this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: When exactly was the second to last hospitalization of patient <PERSON_ID>8621568400785831320</PERSON_ID> within this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Can you tell me when was the prior hospital admission to the last admission date of patient <PERSON_ID>8621568400785831320</PERSON_ID> as of this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: At what time was the prior hospital admission to the last hospitalization of patient <PERSON_ID>8621568400785831320</PERSON_ID> during the current year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: What is the timestamp for the next-to-last start of the hospital stay of patient <PERSON_ID>8621568400785831320</PERSON_ID> this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Do you know when was the visit before the last one hospital visit of patient <PERSON_ID>8621568400785831320</PERSON_ID> within this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: When exactly was the second to last inpatient admission of patient <PERSON_ID>8621568400785831320</PERSON_ID> throughout this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: What is the timestamp for the admission before the last hospitalization of patient <PERSON_ID>8621568400785831320</PERSON_ID> since January?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Do you know when was the penultimate hospital admission time of patient <PERSON_ID>8621568400785831320</PERSON_ID> from the beginning of this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: When exactly was the second to last admit time of patient <PERSON_ID>8621568400785831320</PERSON_ID> this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Identify the time of the second latest hospital admission of patient <PERSON_ID>8621568400785831320</PERSON_ID> since January?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: What was the date of the visit before the last one hospital visit of patient <PERSON_ID>8621568400785831320</PERSON_ID> in the current year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: What was the date of the second latest hospital entry time of patient <PERSON_ID>8621568400785831320</PERSON_ID> from the beginning of this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: I'd like to know the time of the hospital stay before the most recent one hospital admission of patient <PERSON_ID>8621568400785831320</PERSON_ID> in this calendar year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Do you know when was the admission before the last hospital visit of patient <PERSON_ID>8621568400785831320</PERSON_ID> within this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: What was the date of the one before the most recent inpatient admission of patient <PERSON_ID>8621568400785831320</PERSON_ID> this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Can you tell me when was the one just before the last inpatient admission of patient <PERSON_ID>8621568400785831320</PERSON_ID> throughout this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Please provide the date of the one just before the last hospital visit of patient <PERSON_ID>8621568400785831320</PERSON_ID> from the beginning of this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: When was the prior hospital admission to the last hospital admission of patient <PERSON_ID>8621568400785831320</PERSON_ID> as of this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: When was the visit before the last one hospital entry time of patient <PERSON_ID>8621568400785831320</PERSON_ID> as of this year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: Identify the time of the one before the most recent admission date of patient <PERSON_ID>8621568400785831320</PERSON_ID> in the current year?\n\nSQL:", "output": "SELECT vo.visit_start_datetime FROM visit_occurrence vo WHERE vo.person_id = 8621568400785831320 AND EXTRACT(YEAR FROM vo.visit_start_datetime) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY vo.visit_start_datetime DESC OFFSET 1 LIMIT 1;"}
{"input": "Question: When was the last time that patient <PERSON_ID>4424182300748163057</PERSON_ID> had a <MEASUREMENT>43533729</MEASUREMENT> output until last year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: What is the most recent <MEASUREMENT>43533729</MEASUREMENT> output recorded for patient <PERSON_ID>4424182300748163057</PERSON_ID> before this year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: When did patient <PERSON_ID>4424182300748163057</PERSON_ID> last have a <MEASUREMENT>43533729</MEASUREMENT> output measured prior to this year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: Can you tell me the latest <MEASUREMENT>43533729</MEASUREMENT> output for patient <PERSON_ID>4424182300748163057</PERSON_ID> that occurred before this year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: Provide the last date patient <PERSON_ID>4424182300748163057</PERSON_ID> had a <MEASUREMENT>43533729</MEASUREMENT> output prior to this year.\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: On what date did patient <PERSON_ID>4424182300748163057</PERSON_ID> most recently have a <MEASUREMENT>43533729</MEASUREMENT> output before this year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: When was the previous occurrence of <MEASUREMENT>43533729</MEASUREMENT> for patient <PERSON_ID>4424182300748163057</PERSON_ID> before this year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: When was the latest instance of <MEASUREMENT>43533729</MEASUREMENT> recorded for patient <PERSON_ID>4424182300748163057</PERSON_ID> before this year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: Find the most recent <MEASUREMENT>43533729</MEASUREMENT> for patient <PERSON_ID>4424182300748163057</PERSON_ID> that happened before this year.\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: When was the most recent <MEASUREMENT>43533729</MEASUREMENT> for patient <PERSON_ID>4424182300748163057</PERSON_ID> until last year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: When did patient <PERSON_ID>4424182300748163057</PERSON_ID> last record a <MEASUREMENT>43533729</MEASUREMENT> output up to the end of last year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: By the end of last year, when was the last <MEASUREMENT>43533729</MEASUREMENT> output for patient <PERSON_ID>4424182300748163057</PERSON_ID>?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: Looking back until the end of last year, when did patient <PERSON_ID>4424182300748163057</PERSON_ID> last have a <MEASUREMENT>43533729</MEASUREMENT> measurement?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: Give me the last recorded <MEASUREMENT>43533729</MEASUREMENT> for patient <PERSON_ID>4424182300748163057</PERSON_ID> up to last year.\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: Until the close of last year, when was patient <PERSON_ID>4424182300748163057</PERSON_ID>'s most recent <MEASUREMENT>43533729</MEASUREMENT>?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: How recently before this year did patient <PERSON_ID>4424182300748163057</PERSON_ID> have a <MEASUREMENT>43533729</MEASUREMENT>?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: When exactly was the last <MEASUREMENT>43533729</MEASUREMENT> for patient <PERSON_ID>4424182300748163057</PERSON_ID> before the start of this year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: Before the current year started, when did patient <PERSON_ID>4424182300748163057</PERSON_ID> have their last <MEASUREMENT>43533729</MEASUREMENT> recorded?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: What is the date of the most recent <MEASUREMENT>43533729</MEASUREMENT> for patient <PERSON_ID>4424182300748163057</PERSON_ID> prior to this year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: What was the last <MEASUREMENT>43533729</MEASUREMENT> event for patient <PERSON_ID>4424182300748163057</PERSON_ID> before this year began?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: What is the final recorded <MEASUREMENT>43533729</MEASUREMENT> for patient <PERSON_ID>4424182300748163057</PERSON_ID> up until last year?\n\nSQL:", "output": "SELECT MAX(m.measurement_date) AS last_measurement_date FROM measurement m WHERE m.person_id = 4424182300748163057 AND m.measurement_concept_id = 43533729 AND m.measurement_date < DATE_TRUNC('year', CURRENT_DATE);"}
{"input": "Question: What was the name of the diagnosis that patient <PERSON_ID>1553236252820857312</PERSON_ID> at 9:13:34 received on 3/11/2203?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: What was the name of the diagnosis that patient <PERSON_ID>1553236252820857312</PERSON_ID> received on March 11, 2203 at 09:13:34?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: Which diagnosis did patient <PERSON_ID>1553236252820857312</PERSON_ID> receive at 09:13:34 on the 11th of March, 2203?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: What condition was diagnosed for patient <PERSON_ID>1553236252820857312</PERSON_ID> on 11/03/2203 at 9:13:34 AM?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: Can you tell me what diagnosis patient <PERSON_ID>1553236252820857312</PERSON_ID> was given at 9:13:34 in the morning of March 11, 2203?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: At 9:13:34 AM on 03/11/2203, what diagnosis did patient <PERSON_ID>1553236252820857312</PERSON_ID> receive?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: What diagnosis was made for patient <PERSON_ID>1553236252820857312</PERSON_ID> during the timestamp 03/11/2203 09:13:34?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: Please provide the diagnosis for patient <PERSON_ID>1553236252820857312</PERSON_ID> registered at 9:13:34 AM on the 11th of March, 2203.\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: What was the medical condition given to patient <PERSON_ID>1553236252820857312</PERSON_ID> on 03-11-2203 at exactly 9:13:34?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: Which diagnosis corresponds to the encounter of patient <PERSON_ID>1553236252820857312</PERSON_ID> on March 11th, 2203, at 9:13:34 AM?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: Tell me the diagnosis name assigned to patient <PERSON_ID>1553236252820857312</PERSON_ID> at 09:13:34 on 11 March 2203.\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: What diagnosis did patient <PERSON_ID>1553236252820857312</PERSON_ID> receive around 9:13:34 AM on 03/11/2203?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: Which condition was recorded for patient <PERSON_ID>1553236252820857312</PERSON_ID> on March 11, 2203, at 9:13:34 in the morning?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: Can you identify the diagnosis patient <PERSON_ID>1553236252820857312</PERSON_ID> got on 11 March 2203, time 09:13:34?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: What was the diagnosis made for patient <PERSON_ID>1553236252820857312</PERSON_ID> at 9:13:34 AM on the date 03/11/2203?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: Please return the diagnosis received by patient <PERSON_ID>1553236252820857312</PERSON_ID> on 03/11/2203 at the exact time of 09:13:34.\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: On March 11th, 2203 at 09:13:34 hours, what diagnosis was recorded for patient <PERSON_ID>1553236252820857312</PERSON_ID>?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: At the time of 9:13:34 on 11/03/2203, which diagnosis was given to patient <PERSON_ID>1553236252820857312</PERSON_ID>?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: State the name of the condition diagnosed for patient <PERSON_ID>1553236252820857312</PERSON_ID> at 09:13:34 on 03/11/2203.\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: What was the diagnosis title logged at 9:13:34 in the morning on 11 March 2203 for patient <PERSON_ID>1553236252820857312</PERSON_ID>?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: What diagnosis corresponds to patient <PERSON_ID>1553236252820857312</PERSON_ID> on 03-11-2203, timestamp 9:13:34 AM?\n\nSQL:", "output": "SELECT con.concept_name AS diagnosis_name FROM condition_occurrence c JOIN concept con ON c.condition_concept_id = con.concept_id WHERE c.person_id = 1553236252820857312 AND c.condition_start_datetime = TIMESTAMP '2203-03-11 09:13:34';"}
{"input": "Question: Count the number of discharges for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Give me the number of discharge events for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: How many discharges for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: I'd like to know the number of discharge summaries for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Determine the number of discharge events for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Determine the number of hospital discharges for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Give me the number of discharge summaries for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: What is the number of discharge events for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Count the hospital discharges for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Determine the number of discharge summaries for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Can you count discharge events for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Give me the number of hospital discharges for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Tell me how many discharges for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Determine the number of discharge events for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Determine the number of discharge events for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Can you count discharges for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Determine the number of discharges for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Determine the number of hospital discharges for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Can you count discharges for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Can you count hospital discharges for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: What is the number of discharge summaries for patient <PERSON_ID>8484400133089324627</PERSON_ID> last year.\n\nSQL:", "output": "SELECT COUNT(*) AS discharge_count FROM note n WHERE n.person_id = 8484400133089324627 AND LOWER(n.note_title) LIKE '%discharge%' AND n.note_date >= date_trunc('year', CURRENT_DATE) - INTERVAL '1 year' AND n.note_date < date_trunc('year', CURRENT_DATE);"}
{"input": "Question: Have notes for <PERSON_ID>-4054702097524803546</PERSON_ID> mentioned <CONCEPT_ID>41425009</CONCEPT_ID> on 03/30/last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Did the medical records for <PERSON_ID>-4054702097524803546</PERSON_ID> included <CONCEPT_ID>41425009</CONCEPT_ID> on 03/30/last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Are there any notes for <PERSON_ID>-4054702097524803546</PERSON_ID> included <CONCEPT_ID>41425009</CONCEPT_ID> on 03/30/last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Have clinicians noted for <PERSON_ID>-4054702097524803546</PERSON_ID> noted <CONCEPT_ID>41425009</CONCEPT_ID> on March 30 last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Did the medical records for <PERSON_ID>-4054702097524803546</PERSON_ID> made reference to <CONCEPT_ID>41425009</CONCEPT_ID> as of 03/30 of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Are there any notes for <PERSON_ID>-4054702097524803546</PERSON_ID> mentioned <CONCEPT_ID>41425009</CONCEPT_ID> on 03/30/last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Have medical notes for <PERSON_ID>-4054702097524803546</PERSON_ID> noted <CONCEPT_ID>41425009</CONCEPT_ID> on the 30th of March last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Have medical notes for <PERSON_ID>-4054702097524803546</PERSON_ID> made reference to <CONCEPT_ID>41425009</CONCEPT_ID> during March 30th last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Did the medical records for <PERSON_ID>-4054702097524803546</PERSON_ID> noted <CONCEPT_ID>41425009</CONCEPT_ID> during March 30th last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Have clinicians noted for <PERSON_ID>-4054702097524803546</PERSON_ID> referenced <CONCEPT_ID>41425009</CONCEPT_ID> on March 30 last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Did the medical records for <PERSON_ID>-4054702097524803546</PERSON_ID> noted the use of <CONCEPT_ID>41425009</CONCEPT_ID> on the 30th of March last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Have medical notes for <PERSON_ID>-4054702097524803546</PERSON_ID> mentioned <CONCEPT_ID>41425009</CONCEPT_ID> during March 30th last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Did the medical records for <PERSON_ID>-4054702097524803546</PERSON_ID> made reference to <CONCEPT_ID>41425009</CONCEPT_ID> as of 03/30 of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Were there clinical notes for <PERSON_ID>-4054702097524803546</PERSON_ID> documented <CONCEPT_ID>41425009</CONCEPT_ID> on 03/30/last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Did the medical records for <PERSON_ID>-4054702097524803546</PERSON_ID> noted the use of <CONCEPT_ID>41425009</CONCEPT_ID> on the 30th of March last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Have medical notes for <PERSON_ID>-4054702097524803546</PERSON_ID> included <CONCEPT_ID>41425009</CONCEPT_ID> from March 30th last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Do the notes for <PERSON_ID>-4054702097524803546</PERSON_ID> documented <CONCEPT_ID>41425009</CONCEPT_ID> from March 30th last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Do the notes for <PERSON_ID>-4054702097524803546</PERSON_ID> indicated <CONCEPT_ID>41425009</CONCEPT_ID> as of 03/30 of last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Were there notes for <PERSON_ID>-4054702097524803546</PERSON_ID> noted the use of <CONCEPT_ID>41425009</CONCEPT_ID> on March 30 last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Did the medical records for <PERSON_ID>-4054702097524803546</PERSON_ID> referenced <CONCEPT_ID>41425009</CONCEPT_ID> on 03/30/last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: Were there notes for <PERSON_ID>-4054702097524803546</PERSON_ID> noted <CONCEPT_ID>41425009</CONCEPT_ID> from March 30th last year?\n\nSQL:", "output": "SELECT EXISTS (SELECT 1 FROM note_nlp AS nn JOIN note AS n ON nn.note_id = n.note_id WHERE n.person_id = 4054702097524803546 AND nn.note_nlp_concept_id = 41425009 AND n.note_date = (date_trunc('year', current_date) - interval '1 year') + interval '2 months 29 days') AS concept_mentioned;"}
{"input": "Question: What is the specialty of the physician who performed a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> on the last hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: What's the specialty of the doctor who performed it who was responsible for a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> from the most recent visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Who performed the procedure and what is their specialty who performed a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> from the most recent visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: What was the specialty of the physician who executed a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> from the most recent visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Please provide the specialty of the physician who was responsible for a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> from the most recent visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: What is the physician's specialty who performed a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> in the latest hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Who performed the procedure and what is their specialty who did a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> during the last hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Identify the specialty of the physician who executed a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> during the most recent hospital stay?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Please provide the specialty of the physician who was responsible for a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> from the most recent visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: What's the specialty of the doctor who performed it who executed a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> during the last hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Which medical specialty carried out the procedure who completed a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> on the last hospital admission?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Please provide the specialty of the physician in charge of a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> in the latest hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: What is the physician's specialty who executed a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> on the last hospital admission?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Which specialty does the physician have who was responsible for a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> on the last hospital admission?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Identify the specialty of the physician who did a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> from the most recent visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Identify the specialty of the physician who executed a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> during the last hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Can you tell me the specialty of the doctor who did a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> on the last hospital stay?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: What's the specialty of the doctor who performed it who executed a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> during the last hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: The doctor who did the procedure - what is their specialty who was responsible for a <PROCEDURE>2779573</PROCEDURE> procedure on patient <PERSON_ID>3856814790790267215</PERSON_ID> during their most recent hospitalization?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: What is the medical specialty of the physician who performed a <PROCEDURE>2779573</PROCEDURE> on patient <PERSON_ID>3856814790790267215</PERSON_ID> during their most recent hospital visit?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: Which specialty does the doctor belong to who carried out the <PROCEDURE>2779573</PROCEDURE> for patient <PERSON_ID>3856814790790267215</PERSON_ID> on their last hospitalization?\n\nSQL:", "output": "SELECT c.concept_name AS provider_specialty FROM procedure_occurrence po JOIN visit_occurrence vo ON po.visit_occurrence_id = vo.visit_occurrence_id JOIN provider p ON po.provider_id = p.provider_id JOIN concept c ON p.specialty_concept_id = c.concept_id WHERE po.procedure_occurrence_id = 2779573 AND vo.person_id = 3856814790790267215 AND vo.visit_start_datetime = (SELECT MAX(vo2.visit_start_datetime) FROM visit_occurrence vo2 WHERE vo2.person_id = 3856814790790267215);"}
{"input": "Question: What are the top six conditions lasting more than 1 year among patients aged 50's until 01/2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the the six most reported conditions lasting longer than a year among patients who are in their 50s before February 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the the six most reported conditions persisting for more than a year among patients aged 50-59 up to and including January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the six leading conditions persisting for more than a year among patients between 50 and 59 years old until the end of January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the the top 6 conditions that have lasted more than one year among patients aged 50-59 as of January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the the top 6 conditions with a duration over one year among patients between 50 and 59 years old as of January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the six most prevalent conditions that have lasted more than one year among patients aged in their 50s as of January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the the six leading conditions that have lasted more than one year among patients who are in their 50s until the end of January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the six most prevalent conditions lasting over a year among patients in their fifties up to and including January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the six most prevalent conditions persisting for more than a year among patients who are in their 50s up to and including January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the the top 6 conditions lasting over a year among patients aged 50-59 up to Jan 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the the six leading conditions lasting longer than a year among patients in their fifties up to and including January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the six most prevalent conditions persisting for more than a year among patients between 50 and 59 years old up to and including January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the the top 6 conditions lasting over a year among patients between 50 and 59 years old up to Jan 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the the six most reported conditions lasting over a year among patients aged in their 50s up to Jan 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the six leading conditions that have lasted more than one year among patients who are in their 50s until the end of January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the six leading conditions with a duration over one year among patients who are in their 50s until the end of January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the the six leading conditions lasting over a year among patients aged 50-59 up to and including January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the six most prevalent conditions lasting longer than a year among patients aged in their 50s up to and including January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the six most prevalent conditions that have lasted more than one year among patients who are in their 50s as of January 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
{"input": "Question: What are the six leading conditions that have lasted more than one year among patients between 50 and 59 years old up to Jan 2187?\n\nSQL:", "output": "SELECT c.concept_name AS condition_name, COUNT(DISTINCT ce.person_id) AS patient_count FROM condition_era ce JOIN concept c ON ce.condition_concept_id = c.concept_id JOIN person p ON ce.person_id = p.person_id WHERE ce.condition_era_start_date < DATE '2187-02-01' AND ce.condition_era_end_date > ce.condition_era_start_date + INTERVAL '1 year' AND DATE_PART('year', ce.condition_era_start_date) - p.year_of_birth BETWEEN 50 AND 59 GROUP BY c.concept_name ORDER BY patient_count DESC LIMIT 6;"}
