import json

# Données d'entrée : liste de dictionnaires (extrait partagé)
data = [
  {
    "question_name": "Compare the number of deaths caused by <CONDITION>Acute myocardial infarction</CONDITION> among men aged 30's who previously received a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure before and after 2010.",
    "question_concept": "Compare the number of deaths caused by <CONDITION>312327</CONDITION> among men aged 30's who previously received a <PROCEDURE>2004844</PROCEDURE> procedure before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Give the death toll attributed to <CONDITION>Acute myocardial infarction</CONDITION> among males aged 30-39 after receiving a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, contrasting pre- and post-2010 outcomes.",
    "question_concept": "Give the death toll attributed to <CONDITION>312327</CONDITION> among males aged 30-39 after receiving a <PROCEDURE>2004844</PROCEDURE> procedure, contrasting pre- and post-2010 outcomes.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "How many deaths were caused by <CONDITION>Acute myocardial infarction</CONDITION> among men in their 30s who had a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, contrasting pre- and post-2010 outcomes.",
    "question_concept": "How many deaths were caused by <CONDITION>312327</CONDITION> among men in their 30s who had a <PROCEDURE>2004844</PROCEDURE> procedure, contrasting pre- and post-2010 outcomes.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Break down the deaths related to <CONDITION>Acute myocardial infarction</CONDITION> in males aged 30 to 39 who underwent a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure before and after 2010.",
    "question_concept": "Break down the deaths related to <CONDITION>312327</CONDITION> in males aged 30 to 39 who underwent a <PROCEDURE>2004844</PROCEDURE> procedure before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Identify the number of deaths involving <CONDITION>Acute myocardial infarction</CONDITION> among 30-39-year-old men following a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "question_concept": "Identify the number of deaths involving <CONDITION>312327</CONDITION> among 30-39-year-old men following a <PROCEDURE>2004844</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Compare deaths from <CONDITION>Acute myocardial infarction</CONDITION> among 30-39-year-old men following a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure and determine differences between pre- and post-2010.",
    "question_concept": "Compare deaths from <CONDITION>312327</CONDITION> among 30-39-year-old men following a <PROCEDURE>2004844</PROCEDURE> procedure and determine differences between pre- and post-2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "How many deaths were caused by <CONDITION>Acute myocardial infarction</CONDITION> in men aged between 30 and 39 who previously received a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, contrasting pre- and post-2010 outcomes.",
    "question_concept": "How many deaths were caused by <CONDITION>312327</CONDITION> in men aged between 30 and 39 who previously received a <PROCEDURE>2004844</PROCEDURE> procedure, contrasting pre- and post-2010 outcomes.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "What is the number of deaths caused by <CONDITION>Acute myocardial infarction</CONDITION> among men in their 30s who had a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure before and after 2010.",
    "question_concept": "What is the number of deaths caused by <CONDITION>312327</CONDITION> among men in their 30s who had a <PROCEDURE>2004844</PROCEDURE> procedure before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Determine how many deaths occurred due to <CONDITION>Acute myocardial infarction</CONDITION> among men in their 30s who had a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, both before and after the year 2010.",
    "question_concept": "Determine how many deaths occurred due to <CONDITION>312327</CONDITION> among men in their 30s who had a <PROCEDURE>2004844</PROCEDURE> procedure, both before and after the year 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "How many deaths were caused by <CONDITION>Acute myocardial infarction</CONDITION> among males aged 30-39 after receiving a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure in the years before and after 2010.",
    "question_concept": "How many deaths were caused by <CONDITION>312327</CONDITION> among males aged 30-39 after receiving a <PROCEDURE>2004844</PROCEDURE> procedure in the years before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "What is the number of deaths caused by <CONDITION>Acute myocardial infarction</CONDITION> in 30s-aged men who had undergone a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, divided into before and after 2010.",
    "question_concept": "What is the number of deaths caused by <CONDITION>312327</CONDITION> in 30s-aged men who had undergone a <PROCEDURE>2004844</PROCEDURE> procedure, divided into before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Break down the deaths related to <CONDITION>Acute myocardial infarction</CONDITION> in men aged 30s who went through a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure and determine differences between pre- and post-2010.",
    "question_concept": "Break down the deaths related to <CONDITION>312327</CONDITION> in men aged 30s who went through a <PROCEDURE>2004844</PROCEDURE> procedure and determine differences between pre- and post-2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Give the death toll attributed to <CONDITION>Acute myocardial infarction</CONDITION> in men aged between 30 and 39 who previously received a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, both before and after the year 2010.",
    "question_concept": "Give the death toll attributed to <CONDITION>312327</CONDITION> in men aged between 30 and 39 who previously received a <PROCEDURE>2004844</PROCEDURE> procedure, both before and after the year 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Examine how many male individuals aged 30-39 died because of <CONDITION>Acute myocardial infarction</CONDITION> among men in their 30s who had a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, comparing the periods before and after 2010.",
    "question_concept": "Examine how many male individuals aged 30-39 died because of <CONDITION>312327</CONDITION> among men in their 30s who had a <PROCEDURE>2004844</PROCEDURE> procedure, comparing the periods before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Compare deaths from <CONDITION>Acute myocardial infarction</CONDITION> in men aged 30s who went through a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "question_concept": "Compare deaths from <CONDITION>312327</CONDITION> in men aged 30s who went through a <PROCEDURE>2004844</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Look into the death rate from <CONDITION>Acute myocardial infarction</CONDITION> among men in their 30s who had a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, both before and after the year 2010.",
    "question_concept": "Look into the death rate from <CONDITION>312327</CONDITION> among men in their 30s who had a <PROCEDURE>2004844</PROCEDURE> procedure, both before and after the year 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Compare deaths from <CONDITION>Acute myocardial infarction</CONDITION> for male patients aged 30-39 with a history of a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, comparing the periods before and after 2010.",
    "question_concept": "Compare deaths from <CONDITION>312327</CONDITION> for male patients aged 30-39 with a history of a <PROCEDURE>2004844</PROCEDURE> procedure, comparing the periods before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "State the number of deaths involving <CONDITION>Acute myocardial infarction</CONDITION> among men in their 30s who had a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "question_concept": "State the number of deaths involving <CONDITION>312327</CONDITION> among men in their 30s who had a <PROCEDURE>2004844</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Count deaths attributed to <CONDITION>Acute myocardial infarction</CONDITION> among males aged 30-39 after receiving a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "question_concept": "Count deaths attributed to <CONDITION>312327</CONDITION> among males aged 30-39 after receiving a <PROCEDURE>2004844</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Assess the mortality linked to <CONDITION>Acute myocardial infarction</CONDITION> in males aged 30 to 39 who underwent a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure before and after 2010.",
    "question_concept": "Assess the mortality linked to <CONDITION>312327</CONDITION> in males aged 30 to 39 who underwent a <PROCEDURE>2004844</PROCEDURE> procedure before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "What is the number of deaths caused by <CONDITION>Acute myocardial infarction</CONDITION> among males aged 30-39 after receiving a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure and determine differences between pre- and post-2010.",
    "question_concept": "What is the number of deaths caused by <CONDITION>312327</CONDITION> among males aged 30-39 after receiving a <PROCEDURE>2004844</PROCEDURE> procedure and determine differences between pre- and post-2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Compare how many men in their 30s died from <CONDITION>Acute myocardial infarction</CONDITION> in males aged 30 to 39 who underwent a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure before and after 2010.",
    "question_concept": "Compare how many men in their 30s died from <CONDITION>312327</CONDITION> in males aged 30 to 39 who underwent a <PROCEDURE>2004844</PROCEDURE> procedure before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Count deaths attributed to <CONDITION>Acute myocardial infarction</CONDITION> for male patients aged 30-39 with a history of a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, looking at trends before and after 2010.",
    "question_concept": "Count deaths attributed to <CONDITION>312327</CONDITION> for male patients aged 30-39 with a history of a <PROCEDURE>2004844</PROCEDURE> procedure, looking at trends before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Look into the death rate from <CONDITION>Acute myocardial infarction</CONDITION> in males aged 30 to 39 who underwent a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, comparing the periods before and after 2010.",
    "question_concept": "Look into the death rate from <CONDITION>312327</CONDITION> in males aged 30 to 39 who underwent a <PROCEDURE>2004844</PROCEDURE> procedure, comparing the periods before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "What is the number of deaths caused by <CONDITION>Acute myocardial infarction</CONDITION> in 30s-aged men who had undergone a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, comparing the periods before and after 2010.",
    "question_concept": "What is the number of deaths caused by <CONDITION>312327</CONDITION> in 30s-aged men who had undergone a <PROCEDURE>2004844</PROCEDURE> procedure, comparing the periods before and after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Count deaths attributed to <CONDITION>Acute myocardial infarction</CONDITION> in males aged 30 to 39 who underwent a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "question_concept": "Count deaths attributed to <CONDITION>312327</CONDITION> in males aged 30 to 39 who underwent a <PROCEDURE>2004844</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Report the number of men in their 30s who died from <CONDITION>Acute myocardial infarction</CONDITION> in men in their thirties who had received a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "question_concept": "Report the number of men in their 30s who died from <CONDITION>312327</CONDITION> in men in their thirties who had received a <PROCEDURE>2004844</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Report the number of men in their 30s who died from <CONDITION>Acute myocardial infarction</CONDITION> in 30s-aged men who had undergone a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure, contrasting pre- and post-2010 outcomes.",
    "question_concept": "Report the number of men in their 30s who died from <CONDITION>312327</CONDITION> in 30s-aged men who had undergone a <PROCEDURE>2004844</PROCEDURE> procedure, contrasting pre- and post-2010 outcomes.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
  {
    "question_name": "Give the death toll attributed to <CONDITION>Acute myocardial infarction</CONDITION> in men aged 30s who went through a <PROCEDURE>Repair of other current obstetric laceration</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "question_concept": "Give the death toll attributed to <CONDITION>312327</CONDITION> in men aged 30s who went through a <PROCEDURE>2004844</PROCEDURE> procedure prior to their death, before vs. after 2010.",
    "sql": "WITH deaths_in_30s_male AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT d.death_date FROM deaths_in_30s_male AS d JOIN procedure_occurrence AS po ON d.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < d.death_datetime WHERE d.age_at_death BETWEEN 30 AND 39), death_before_2010 AS (SELECT COUNT(*) AS count_before_2010 FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after_2010 AS(SELECT COUNT(*) AS count_after_2010 FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before_2010, da.count_after_2010, da.count_after_2010 - db.count_before_2010 AS difference FROM death_before_2010 AS db CROSS JOIN death_after_2010 AS da;",
    "template": "Compare the number of deaths caused by {diagnosis_name} among men aged 30's who previously received a {procedure_name} procedure before and after 2010."
  },
]

# Nouveau SQL à insérer
new_sql = "WITH deaths_total AS (SELECT d.person_id, d.death_date, d.death_datetime, EXTRACT(YEAR FROM AGE(d.death_date, p.birth_datetime)) AS age_at_death FROM death AS d JOIN person AS p ON d.person_id = p.person_id WHERE d.cause_concept_id = 312327 AND p.gender_concept_id = 8507), qualified_deaths AS (SELECT dt.death_date FROM deaths_total AS dt JOIN procedure_occurrence AS po ON dt.person_id = po.person_id AND po.procedure_concept_id = 2004844 AND po.procedure_datetime < dt.death_datetime WHERE dt.age_at_death BETWEEN 30 AND 39), death_before AS (SELECT COUNT(*) AS count_before FROM qualified_deaths AS q WHERE q.death_date < DATE '2010-01-01'), death_after AS(SELECT COUNT(*) AS count_after FROM qualified_deaths AS qd WHERE qd.death_date >= DATE '2010-01-01') SELECT db.count_before, da.count_after, da.count_after - db.count_before AS difference FROM death_before AS db CROSS JOIN death_after AS da;"


# Remplacement du champ "sql"
for entry in data:
    entry["sql"] = new_sql

# Affichage (ou sauvegarde) du résultat
print(json.dumps(data, indent=2))